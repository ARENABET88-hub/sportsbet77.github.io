import.meta;var Kn=Object.defineProperty,Vn=Object.defineProperties,Gn=Object.getOwnPropertyDescriptors,Nt=Object.getOwnPropertySymbols,Yn=Object.prototype.hasOwnProperty,Qn=Object.prototype.propertyIsEnumerable,Ve=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e),Ge=(e,t,r)=>t in e?Kn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,w=(e,t)=>{for(var r in t||(t={}))Yn.call(t,r)&&Ge(e,r,t[r]);if(Nt)for(var r of Nt(t))Qn.call(t,r)&&Ge(e,r,t[r]);return e},I=(e,t)=>Vn(e,Gn(t)),d=(e,t,r)=>(Ge(e,typeof t!="symbol"?t+"":t,r),r),Ye=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},j=(e,t,r)=>(Ye(e,t,"read from private field"),r?r.call(e):t.get(e)),ne=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},Lt=(e,t,r,n)=>(Ye(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),Pe=(e,t,r)=>(Ye(e,t,"access private method"),r),F=function(e,t){this[0]=e,this[1]=t},re=(e,t,r)=>{var n=(o,s,c,l)=>{try{var u=r[o](s),h=(s=u.value)instanceof F,g=u.done;Promise.resolve(h?s[0]:s).then(m=>h?n(o==="return"?o:"next",s[1]?{done:m.done,value:m.value}:m,c,l):c({value:m,done:g})).catch(m=>n("throw",m,c,l))}catch(m){l(m)}},a=o=>i[o]=s=>new Promise((c,l)=>n(o,s,c,l)),i={};return r=r.apply(e,t),i[Ve("asyncIterator")]=()=>i,a("next"),a("throw"),a("return"),i},B=(e,t,r)=>(t=e[Ve("asyncIterator")])?t.call(e):(e=e[Ve("iterator")](),t={},r=(n,a)=>(a=e[n])&&(t[n]=i=>new Promise((o,s,c)=>(i=a.call(e,i),c=i.done,Promise.resolve(i.value).then(l=>o({value:l,done:c}),s)))),r("next"),r("return"),t);const Jn=":host{display:flex;align-items:center;justify-content:center}";class Xn extends HTMLElement{constructor(){var t,r;super(),d(this,"size"),d(this,"color"),this.size=(t=this.getAttribute("size"))!=null?t:"1.5rem",this.color=(r=this.getAttribute("color"))!=null?r:"gray",this.attachShadow({mode:"open"})}connectedCallback(){this.render();const t=document.createElement("style");t.textContent=Jn,this.shadowRoot.appendChild(t)}render(){const t=this.shadowRoot,r='\n      width="'.concat(this.size,'"\n      height="').concat(this.size,'"\n      xmlns="http://www.w3.org/2000/svg"\n      aria-hidden="true"\n    ');switch(this.getAttribute("name")){case"warning":t.innerHTML="\n          <svg ".concat(r,' viewBox="0 0 16 14" fill="').concat(this.color,'">\n            <path d="M5.925 2.344c1.146-1.889 3.002-1.893 4.149 0l4.994 8.235c1.146 1.889.288 3.421-1.916 3.421h-10.305c-2.204 0-3.063-1.529-1.916-3.421l4.994-8.235zm1.075 1.656v5h2v-5h-2zm0 6v2h2v-2h-2z"/>\n          </svg>\n        ');break;case"close":t.innerHTML="\n          <svg ".concat(r,' viewBox="0 0 20 20" fill="').concat(this.color,'">\n            <path d="M17.1 4.3l-1.4-1.4-5.7 5.7-5.7-5.7-1.4 1.4 5.7 5.7-5.7 5.7 1.4 1.4 5.7-5.7 5.7 5.7 1.4-1.4-5.7-5.7z"/>\n          </svg>\n        ');break;default:t.innerHTML="";break}}}const Zn="#overlay{position:fixed;width:100%;height:100%;background:#0006;top:0;left:0;z-index:2147483647;animation:modalPop .3s ease-out}#modal{position:fixed;top:1em;left:50%;width:100%;max-width:460px;transform:translate(-50%,-100%);background:#fff;color:#000;border:1px solid #d0d0d0;border-radius:4px;animation:modalSlideInFromTop .3s forwards}@keyframes modalPop{0%{opacity:0}to{opacity:1}}@keyframes modalSlideInFromTop{0%{transform:translate(-50%,-100%)}to{transform:translate(-50%)}}@keyframes modalSlideInFromBottom{0%{transform:translate(-50%,100%)}to{transform:translate(-50%)}}@media only screen and (max-width: 640px){#modal{top:auto;bottom:0;animation:modalSlideInFromBottom .3s forwards}}#modal header,#modal footer{padding:1em}#modal header{display:flex;margin-bottom:2em;text-align:center;border-bottom:1px solid #d0d0d0}#title{flex-grow:2;display:flex;justify-content:center;font-size:1.6rem;margin:0}#title svg-icon{margin-right:.25em}#content{text-align:left;padding:0 1em 1em;overflow:auto;max-height:84vh}#modal #content p{margin:0}#close-icon,#close-button{cursor:pointer}#close-icon{min-width:24px;background:transparent;padding:0;border:none}#close-button{width:100%;padding:1em;color:#fff;background-color:#1773b0;border:none;border-radius:4px}#close-button:hover,#close-button:active{background:#136f99}#close-button:active,#close-button:focus{box-shadow:0 0 0 4px #1990c640}";var Qt=/^\s*at .*(\S+:\d+|\(native\))/m,er=/^(eval@)?(\[native code])?$/;function tr(e){return e.stack?e.stack.match(Qt)?nr(e):rr(e):[]}function Jt(e){if(e.indexOf(":")===-1)return[e];let t=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));return[t[1],t[2]?Number(t[2]):void 0,t[3]?Number(t[3]):void 0]}function nr(e){return e.stack.split("\n").filter(t=>!!t.match(Qt)).map(t=>{let r=t.replace(/^\s+/,"").replace(/^.*?\s+/,""),n=r.match(/ (\(.+\)$)/);r=n?r.replace(n[0],""):r;let a=Jt(n?n[1]:r),i=n&&r||void 0,o=["eval","<anonymous>"].indexOf(a[0])>-1?void 0:a[0];return{method:i,file:o,lineNumber:a[1],columnNumber:a[2]}})}function rr(e){return e.stack.split("\n").filter(t=>!t.match(er)).map(t=>{if(t.indexOf("@")===-1&&t.indexOf(":")===-1)return{method:t};let r=/((.*".+"[^@]*)?[^@]*)(?:@)/,n=t.match(r),a=n&&n[1]?n[1]:void 0,i=Jt(t.replace(r,""));return{method:a,file:i[0],lineNumber:i[1],columnNumber:i[2]}})}var Rt="5",ar=class{constructor(e){d(this,"breadcrumbs",[]),d(this,"apiKey"),d(this,"plugins"),d(this,"appId"),d(this,"appType"),d(this,"appVersion"),d(this,"releaseStage"),d(this,"locale"),d(this,"userAgent"),d(this,"metadata"),d(this,"persistedMetadata"),d(this,"onError"),d(this,"onPostErrorListeners",[]);var t;this.apiKey=e.apiKey,this.appType=e.appType,this.appId=e.appId,this.appVersion=e.appVersion,this.releaseStage=e.releaseStage,this.locale=e.locale,this.userAgent=e.userAgent,this.metadata=e.metadata,this.onError=e.onError,this.persistedMetadata={},this.plugins=(t=e.plugins)!=null?t:[],this.plugins.forEach(r=>r.load(this)),this.leaveBreadcrumb("Bugsnag started",void 0,"state")}addMetadata(e){for(let t of Object.keys(e))this.persistedMetadata[t]=e[t]}leaveBreadcrumb(e,t,r="manual"){this.breadcrumbs.push({name:e,metaData:t,type:r,timestamp:new Date().toISOString()})}notify(e,{errorClass:t,severity:r,severityType:n,handled:a=!0,metadata:i,context:o}={}){var s,c;let l=w(w(w({},this.metadata),this.persistedMetadata),i),u=this.buildBugsnagEvent({error:e,errorClass:t,severityType:n,handled:a,severity:r,metadata:l,context:o});if(((c=(s=this.onError)==null?void 0:s.call(this,u,e))==null||c)&&this.releaseStage!=="development"){let h=this.sendToBugsnag(u);return this.onPostErrorListeners.forEach(g=>g(u)),h}return Promise.resolve()}addOnPostError(e){this.onPostErrorListeners.push(e)}buildBugsnagEvent({error:e,errorClass:t,severity:r="error",severityType:n="handledException",handled:a,metadata:i={},context:o}){let s=new Date().toISOString(),{breadcrumbs:c,appId:l,appType:u,appVersion:h,releaseStage:g,locale:m,userAgent:C}=this;return{payloadVersion:Rt,exceptions:[{errorClass:t!=null?t:e.name,stacktrace:Xt(l,e),message:e.message}],severity:r,severityReason:{type:n},unhandled:!a,app:{id:l,type:u,version:h,releaseStage:g},device:{time:s,locale:m,userAgent:C},breadcrumbs:c,context:o,metaData:i}}async sendToBugsnag(e){let{apiKey:t}=this,r={apiKey:t,notifier:{name:"Bugsnag JavaScript",version:"7.22.2",url:"https://github.com/bugsnag/bugsnag-js"},events:[e]};try{await fetch("https://notify.bugsnag.com/",{method:"POST",headers:{"Content-Type":"application/json","Bugsnag-Api-Key":t,"Bugsnag-Payload-Version":Rt,"Bugsnag-Sent-At":e.device.time},body:JSON.stringify(r)})}catch(n){console.warn("[bugsnag-light] failed to send an event"),console.warn(n)}}};function Xt(e,t){return tr(t).map(r=>{var n,a,i,o;let s=(n=r.file)==null?void 0:n.includes(e);return{method:(a=r.method)!=null?a:"",file:(i=r.file)!=null?i:"",lineNumber:(o=r.lineNumber)!=null?o:0,columnNumber:r.columnNumber,inProject:s}})}function ir(e){let t=window.onerror;window.onerror=(r,n,a,i,o)=>{o&&e.notify(o,{severityType:"unhandledException",handled:!1}),typeof t=="function"&&t.apply(window.onerror,[r,n,a,i,o])}}function or(e){window.addEventListener("unhandledrejection",({reason:t})=>{t&&e.notify(t,{severityType:"unhandledPromiseRejection",handled:!1})})}function W(e){try{const t=new RegExp("(^| )".concat(e,"=([^;]+)")).exec(document.cookie);if(t){const r=t[2];try{return decodeURIComponent(r)}catch(n){return r}}return null}catch(t){return null}}const et={BRANDED_BUTTON:"shopify-payment-button__button shopify-payment-button__button--branded",UNBRANDED_BUTTON:"shopify-payment-button__button shopify-payment-button__button--unbranded",MORE_PAYMENT_OPTION_BUTTON:"shopify-payment-button__more-options",HIDDEN:"shopify-payment-button__button--hidden"},sr="wallet-cart-button",lr={DARK:"apple-pay--dark",LIGHT:"apple-pay--light"},cr="_shopify_y",Zt=6,dr="discount_code",bt="https://static-na.payments-amazon.com/checkout.js",ur={CURRENCY_CHANGE:"wallet_currency_change"},tt="{{ICON}}",nt="VALIDATION_CUSTOM",en="portable-wallets";class Ee extends Error{constructor({code:t,message:r}){const n="An unexpected error happened likely because of customizations made to HTML/JavaScript on this site ".concat(r);super("[".concat(t,"]: ").concat(n)),d(this,"name","DeveloperError"),d(this,"code","unknown"),this.code=t}}class tn extends Error{constructor({message:t}){super(t),d(this,"name","SilencedError")}}class hr extends Error{constructor(){super(...arguments),d(this,"name","MissingConfigError")}}const pr=["Load failed","Failed to fetch","when attempting to fetch resource"],mr=["Chrome-Lighthouse"],rt={};function yr(e,t){if(!e.exceptions[0])return!1;gr(e);try{return fr(e,t)}catch(r){const n=r;console.error(n);const a={errorClass:"UnfilterableError",message:"Could not properly filter error with message: ".concat(n.message),stacktrace:Xt(en,n)};return e.exceptions.unshift(a),!0}}function gr(e){var t,r;e.context=window.location.pathname,e.request||(e.request={}),e.request.url=window.location.href,e.device.orientation=(r=(t=window.screen)==null?void 0:t.orientation)==null?void 0:r.type,e.metaData=w(w({},rt),e.metaData);const n=e.exceptions[0].stacktrace[0];n&&!n.inProject&&e.unhandled&&(e.severity="warning")}function fr(e,t){var r,n,a,i;if(mr.some(s=>navigator.userAgent.includes(s)))return!1;const o=e.exceptions[0];return pr.some(s=>{var c,l;return(l=(c=o.message)==null?void 0:c.includes(s))!=null?l:!1})?!1:t instanceof Ee?(console.error(t),!1):o.errorClass===tn.name||(r=o.message)!=null&&r.includes("Component closed")||o.stacktrace.some(s=>{var c;return(c=s.file)==null?void 0:c.includes("spin.dev")})||o.errorClass==="OpenTelemetryClientError"&&((n=o.message)!=null&&n.match(/Server responded with ([45]\d\d|undefined)/)||(a=o.message)!=null&&a.includes("error found in #10 byte"))||(i=o.message)!=null&&i.includes("GraphQL mutation failed with status 404")?!1:o.stacktrace.some(s=>!!(s!=null&&s.inProject))}var Yt;const br={apiKey:"cb577dc231be1c7494db8a63441ef66b",appId:en,appVersion:"0.0.0-063000c45e963f30ef2c4e12c6c20591af69f6e7",releaseStage:"production",locale:"en",userAgent:navigator.userAgent,metadata:{user:{id:(Yt=W(cr))!=null?Yt:"unknown"}},onError:yr},b=new ar(br);function wt(e){for(const[t,r]of Object.entries(e))rt[t]=w(w({},rt[t]),r)}var nn={en:{instruments_copy:{checkout:{buy_now:"Buy it now"}},error_dialogs:{checkout:{title:"Transaction failed",generic_error:"Checkout is currently unavailable due to technical problems. Please try again in a few minutes.",button_text:"Return to store"},product:{out_of_stock:"This item is no longer available."},wallet:{title:"%{wallet} unavailable",generic_error:"There was an issue with %{wallet}. Try again or use a different payment method.",buy_with_prime:{empty_line_items:{title:"Buy with Prime no longer available",content:"Items that were eligible for Buy with Prime are no longer in your cart."}}}},more_payment_options:"More payment options",subscriptions:{buyer_consent:"One or more of the items in your cart is a recurring or deferred purchase. By continuing, I agree to the %{subscriptionPolicyLink} and authorize you to charge my payment method at the prices, frequency and dates listed on this page until my order is fulfilled or I cancel, if permitted.",cancellation_policy:"cancellation policy",subscription_policy:"Subscription policy",policy_not_found:"The subscription policy could not be found. Refresh the page or contact us for more information."},shipping_methods:{connect_shipping_methods:"%{methodOne} and %{methodTwo}"},order_summary:{total:"Total",subtotal:"Subtotal",duties:"Duties",taxes:"Taxes",shipping:"Shipping",shipping_one_time_purchase:"Shipping (One-time purchase)",shipping_subscription:"Shipping (Subscription)",discount:"Discount",subscriptions:{recurring_total_tooltip_line:"Does not include shipping, tax, duties, or any applicable discounts",recurring_totals:"%{fixedPrice} every %{interval}",recurring_totals_with_policies:{one:"First payment %{fixedPrice}, then %{recurringPrice} every %{interval}",other:"First %{count} payments %{fixedPrice} each, then %{recurringPrice} every %{interval}"},recurring_total_intervals:{day:{one:"day",other:"%{count} days"},month:{one:"month",other:"%{count} months"},week:{one:"week",other:"%{count} weeks"},year:{one:"year",other:"%{count} years"}}}},brand:{amazon_pay:"Amazon Pay",apple_pay:"Apple Pay",buy_with_prime:"Buy with Prime",paypal:"PayPal",google_pay:"Google Pay",shop_pay:"Shop Pay"},buy_with_button_content:"Buy with {{ICON}}",shop_promise_delivery:{same_day:"Same-day delivery",next_day:"Next-day delivery",two_day:"2-day delivery"},errors:{missing:{email:"Enter an email address",first_name:"Enter a first name",last_name:"Enter a last name",address1:"Enter an address",address2:"Enter an apartment, suite, etc.",city:"Enter a city",zone:"Select a state / province",phone:"Enter a phone number",postal_code:"Enter a ZIP / postal code"},invalid:{email:"Enter a valid email",first_name:"Enter a valid first name",last_name:"Enter a valid last name",address1:"Enter a valid address",address2:"Enter a valid apartment, suite, etc.",city:"Enter a valid city",zone:"Select a valid state / province",country:"Select a country / region",phone:"Enter a valid phone number",postal_code:"Enter a valid zip / postal code",billing_address:"Invalid billing address"},emojis:{first_name:"First name cannot contain emojis",last_name:"Last name cannot contain emojis",city:"City cannot contain emojis",address1:"Address line cannot contain emojis",address2:"Second address line cannot contain emojis",postal_code:"Postal code/zip cannot contain emojis"},too_long:{address1:"Address line is too long",address2:"Second address line is too long",first_name:"First name is too long",last_name:"Last name is too long",city:"City is too long"},url:{first_name:"First name cannot contain a URL",last_name:"Last name cannot contain a URL"},html_tags:{first_name:"First name cannot contain HTML tags",last_name:"Last name cannot contain HTML tags",city:"City cannot contain HTML tags",address1:"Address line cannot contain HTML tags",address2:"Second address line cannot contain HTML tags"}}}};nn.en;function Be(){return new at(nn)}class Ot extends Error{constructor(t,r){const n="i18n: Missing or invalid translation '".concat(t,"' in '").concat(r,"'");super(n)}}class wr extends Error{constructor(t,r,n){const a="i18n: Missing translation template key '".concat(t,"' for '").concat(r,"' in '").concat(n,"'");super(a)}}class Cr extends Error{constructor(t,r,n){const a="i18n: Invalid pluralization for '".concat(t,"':'").concat(r,"' in '").concat(n,"'");super(a)}}var _e,H,Re,rn,Oe,an,xe,on;const Tt=class Uo{constructor(t){ne(this,Re),ne(this,Oe),ne(this,xe),ne(this,_e,void 0),ne(this,H,Uo.getDefaultLanguage()),Lt(this,_e,t)}static getDefaultLanguage(){return"en"}get locale(){return j(this,H)}translate(t,r={}){var n;const a=t.split(".");let i=j(this,_e)[j(this,H)];try{for(const o of a)switch(typeof i){case"object":i=i[o];break;case"string":case"undefined":throw new Ot(t,j(this,H))}if(Pe(this,Re,rn).call(this,i,r)){if(typeof i=="string")throw new Cr(t,i,j(this,H));i=i[Pe(this,Oe,an).call(this,i,r.count)]}if(typeof i!="string")throw new Ot(t,j(this,H));return Pe(this,xe,on).call(this,i,r)}catch(o){return b.notify(o),(n=r.defaultValue)!=null?n:t}}};_e=new WeakMap,H=new WeakMap,Re=new WeakSet,rn=function(e,t){return typeof e!="string"&&t.count!=="undefined"},Oe=new WeakSet,an=function(e,t){let r=t===1?"one":"other";return t===0&&typeof e!="string"&&e.zero!=="undefined"&&(r="zero"),r},xe=new WeakSet,on=function(e,t={}){const r=e.match(/%\{.+?\}/g);return r?r.reduce((n,a)=>{const i=a.replace(/%\{(.*)\}/,"$1");return t[i]?n.replace(a,t[i]):(b.notify(new wr(i,e,j(this,H))),n)},e):e};let at=Tt;var _=(e=>(e.CartPage="cart_page",e.CartAjax="cart_ajax",e.ProductPage="product",e.Checkout="checkout",e.Unknown="unknown",e))(_||{}),be=(e=>(e.CartChange="/cart/change",e.CartUpdate="/cart/update",e.CartAdd="/cart/add",e.CartClear="/cart/clear",e))(be||{}),ve=(e=>(e.OneTimePurchase="ONE_TIME_PURCHASE",e.Subscription="SUBSCRIPTION",e))(ve||{}),vr=0;function ce(e){return"__private_"+vr+++"_"+e}function P(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}function Ct(e){return Object.entries(e).map(([t,r])=>({key:t,value:{stringValue:String(r)}}))}const sn=1,Ar=_r(5,2,12);function _r(e,t,r){const n=[0];for(let a=0;a<r;a++){const i=Math.floor(e*t**a);n.push(i)}return n}var he=ce("exporter"),U=ce("attributes"),O=ce("metrics");class Er{constructor({exporter:t,attributes:r}){Object.defineProperty(this,he,{writable:!0,value:void 0}),Object.defineProperty(this,U,{writable:!0,value:void 0}),Object.defineProperty(this,O,{writable:!0,value:[]}),P(this,he)[he]=t,P(this,U)[U]=r!=null?r:{}}addAttributes(t){P(this,U)[U]=w(w({},P(this,U)[U]),t)}histogram({name:t,value:r,unit:n,bounds:a,attributes:i}){const o=Date.now()*1e6;P(this,O)[O].push({name:t,type:"histogram",value:r,unit:n,timeUnixNano:o,attributes:i,bounds:a})}counter({name:t,value:r,unit:n,attributes:a}){const i=Date.now()*1e6;P(this,O)[O].push({name:t,type:"counter",value:r,unit:n,timeUnixNano:i,attributes:a})}gauge({name:t,value:r,unit:n,attributes:a}){const i=Date.now()*1e6;P(this,O)[O].push({name:t,type:"gauge",value:r,unit:n,timeUnixNano:i,attributes:a})}async exportMetrics(){const t={};P(this,O)[O].forEach(n=>{switch(n.attributes=w(w({},P(this,U)[U]),n.attributes),n.type){case"histogram":Sr(t,n);break;case"counter":Pr(t,n);break;case"gauge":Ir(t,n);break}});const r=Object.values(t);r.length!==0&&(P(this,O)[O]=[],await P(this,he)[he].exportMetrics(r))}}function Sr(e,t){var r;const{name:n,value:a,unit:i,timeUnixNano:o,attributes:s}=t,c=(r=t.bounds)!==null&&r!==void 0?r:Ar,l=new Array(c.length+1).fill(0);e[n]||(e[n]={name:n,unit:i||"1",histogram:{aggregationTemporality:sn,dataPoints:[]}});for(let u=0;u<l.length;u++){const h=c[u];if(h===void 0)l[u]=1;else if(a<=h){l[u]=1;break}}e[n].histogram.dataPoints.push({startTimeUnixNano:o,timeUnixNano:o,count:1,sum:a,min:a,max:a,bucketCounts:l,explicitBounds:c,attributes:Ct(s!=null?s:{})})}function Pr(e,t){const{name:r,value:n,unit:a,timeUnixNano:i,attributes:o}=t;e[r]||(e[r]={name:r,unit:a||"1",sum:{aggregationTemporality:sn,isMonotonic:!0,dataPoints:[]}}),e[r].sum.dataPoints.push({startTimeUnixNano:i,timeUnixNano:i,asDouble:n,attributes:Ct(o!=null?o:{})})}function Ir(e,t){const{name:r,value:n,unit:a,timeUnixNano:i,attributes:o}=t;e[r]||(e[r]={name:r,unit:a||"1",gauge:{dataPoints:[]}}),e[r].gauge.dataPoints.push({startTimeUnixNano:i,timeUnixNano:i,asDouble:n,attributes:Ct(o!=null?o:{})})}var pe=ce("url"),me=ce("serviceName"),ye=ce("logger");class Dr{constructor(t,r,n){Object.defineProperty(this,pe,{writable:!0,value:void 0}),Object.defineProperty(this,me,{writable:!0,value:void 0}),Object.defineProperty(this,ye,{writable:!0,value:void 0}),P(this,pe)[pe]=t,P(this,me)[me]=r,P(this,ye)[ye]=n==null?void 0:n.logger}async exportMetrics(t){var r;const n={resourceMetrics:[{resource:{attributes:[{key:"service.name",value:{stringValue:P(this,me)[me]}}]},scopeMetrics:[{scope:{name:"open-telemetry-mini-client",version:"0.3.3",attributes:[]},metrics:t}]}]},a=await fetch(P(this,pe)[pe],{method:"POST",keepalive:!0,headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if((r=P(this,ye)[ye])===null||r===void 0||r.log({status:a.status}),!a.ok){if(a.status===400){const i=await a.text();throw new De("Invalid OpenTelemetry Metrics: ".concat(i))}if(a.status===429||a.status===503){const i=await a.json(),o=a.headers.get("Retry-After"),s=o?{seconds:Number(o)}:void 0;throw new De("Server did not accept metrics",{errorData:i,retryAfter:s,metrics:t})}throw new De("Server responded with ".concat(a.status))}}}class De extends Error{constructor(t,r){super(t),this.metadata=void 0,this.name="OpenTelemetryClientError",this.metadata=r}}const Tr="https://otlp-http-production.shopifysvc.com/v1/metrics",kr="portable_wallets";class Nr{constructor(t){this.exporter=t}async exportMetrics(t){var r;try{await this.exporter.exportMetrics(t)}catch(n){if(n instanceof De){const a=(r=n.metadata)==null?void 0:r.retryAfter;if(a){await new Promise(i=>{setTimeout(()=>{this.exportMetrics(t),i()},a.seconds*1e3)});return}}throw n}}}const Lr=new Dr(Tr,kr),Rr=new Nr(Lr),E=new Er({exporter:Rr}),we=[];function x(e,t,r){if(window.customElements==null)return;const n=t;window.customElements.get(e)||(window.customElements.define(e,n),r!=null&&r.isChildCustomElement&&we.push(e))}function Or(){var e;const t=(e=window.Shopify)==null?void 0:e.CartType;let r=_.ProductPage;return window.Shopify?t===_.CartAjax?r=_.CartAjax:t===_.CartPage&&(r=_.CartPage):r=_.Unknown,r}function it(e){return Number(e).toFixed(2)}function Ue(e){if(!(!e||!e.id||!e.id.includes("gid://shopify/Cart/")))return e.id.replace("gid://shopify/Cart/","").split("?")[0]}function M(){let e;return[new Promise(t=>e=t),e]}const xr={force_shop_pay_product:"direct_checkout_product",force_shop_pay_cart:"direct_checkout_cart"};function Z(e,t="no_redirect_for_checkout"){E.exportMetrics();const r=new URL(e);switch(t){case"skip_shop_pay":r.searchParams.set("skip_shop_pay","true");break;case"no_redirect_for_checkout":r.searchParams.set("storefront_wallet","true");break;case"force_shop_pay_cart":case"force_shop_pay_product":case"force_shop_pay":{r.searchParams.set("payment","shop_pay");const n=xr[t];n&&r.searchParams.set("redirect_source",n);break}}window.location.assign(r.toString())}function ln(){return!!document.querySelector('[data-source-attribution="shopify.shop-promise-pdp"]')}class Fr extends HTMLElement{constructor(){super(),d(this,"overflow"),d(this,"formerFocus"),this.attachShadow({mode:"open"}),this.overflow="",this.formerFocus=document.activeElement}connectedCallback(){const t=Be();this.render(t);const r=this.shadowRoot,n=r.getElementById("modal");r.querySelectorAll("button").forEach(o=>o.addEventListener("click",this.closeModal.bind(this)));const a=r.getElementById("overlay");a==null||a.addEventListener("click",o=>this.handleOutsideClick(o,n)),document.addEventListener("keydown",this.handleEscapeKey.bind(this));const i=document.createElement("style");i.textContent=Zn,r.appendChild(i),this.overflow=document.body.style.overflow,document.body.style.overflow="hidden",this.trapFocus(n,r),x("svg-icon",Xn)}trapFocus(t,r){if(!t)return;const n=t.querySelectorAll("a[href], button"),a=Array.from(n),i=a[0],o=a[a.length-1];t.addEventListener("keydown",s=>{s.key==="Tab"&&!s.shiftKey&&r.activeElement===o&&(s.preventDefault(),i.focus()),s.key==="Tab"&&s.shiftKey&&r.activeElement===i&&(s.preventDefault(),o.focus())}),i.focus()}handleOutsideClick(t,r){r&&(r.contains(t.target)||this.closeModal())}handleEscapeKey(t){t.key==="Escape"&&this.closeModal()}closeModal(){var t;document.body.style.overflow=this.overflow,this.remove(),this.formerFocus&&"focus"in(this==null?void 0:this.formerFocus)&&typeof this.formerFocus.focus=="function"&&((t=this.formerFocus)==null||t.focus())}render(t){const r=this.getAttribute("title"),n=this.getAttribute("has-close-button"),a=t.translate("error_dialogs.checkout.button_text"),i='\n      <footer>\n        <button type="button" id="close-button" tabindex="0">'.concat(a,"</button>\n      </footer>\n    ");this.shadowRoot.innerHTML='\n      <div id="overlay">\n        <div id="modal" role="dialog" aria-modal="true" aria-labelledby="title">\n          <header>\n            <h2 id="title">\n              '.concat(r,'\n            </h2>\n            <button type="button" id="close-icon" aria-label=').concat(a,' tabindex="0">\n              <svg-icon name="close" color="gray"></svg-icon>\n            </button>\n          </header>\n          <div id="content">\n            <p><slot></slot></p>\n          </div>\n          ').concat(n?i:"","\n        </div>\n      </div>\n    ")}}function $r(e){e.setAttribute("tabindex","0")}function ze(e="button"){const t=document.createElement("button");return $r(t),t.type=e,e!=="submit"&&(t.role="button"),t}function V(e,t){for(const[r,n]of Object.entries(t))e.setAttribute(r,n)}function Q(e,t){for(const[r,n]of Object.entries(t))e.style.setProperty(r,n)}function q(e,t){const r=document.createElement("top-level-modal");r.textContent=t,V(r,{"data-testid":"top-level-modal","has-close-button":"true",title:'<svg-icon name="warning" color="red"></svg-icon> '.concat(e)}),document.body.appendChild(r)}function cn(e,t){const r=document.createElement("top-level-modal");r.innerHTML=t,V(r,{"data-testid":"top-level-modal",title:e}),document.body.appendChild(r)}function Se(e){q(e.translate("error_dialogs.checkout.title"),e.translate("error_dialogs.product.out_of_stock"))}x("top-level-modal",Fr);class He extends HTMLElement{get buyerCountry(){return this.getAttribute("buyer-country")}get recommendedInstrument(){return this.getAttribute("recommended-instrument")}get buyerCurrency(){const t=this.getAttribute("buyer-currency");if(t==null)throw new Error("WalletElement buyer-currency is null");return t}get accessToken(){return this.getAttribute("access-token")}get disabled(){return this.hasAttribute("disabled")}set disabled(t){this.toggleAttribute("disabled",t)}get hasSellingPlan(){const t=this.getAttribute("has-selling-plan");return t==="true"||t===""}set hasSellingPlan(t){t?this.setAttribute("has-selling-plan",""):this.removeAttribute("has-selling-plan")}get isShippingRequired(){const t=this.getAttribute("requires-shipping");return t==="true"||t===""}set isShippingRequired(t){t?this.setAttribute("requires-shipping",""):this.removeAttribute("requires-shipping")}}const Mr="#more-payment-options-link{cursor:pointer}";var p=(e=>(e.InvalidLanguage="Variable $language of type LanguageCode was provided invalid value",e.InvalidCountry="Variable $country of type CountryCode was provided invalid value",e.MissingCartId="Variable $cartId of type ID! was provided invalid value",e.BuyerIdentityInvalidCountry="Variable $buyerIdentity of type CartBuyerIdentityInput! was provided invalid value for countryCode",e.BuyerIdentityInvalidPhone="INVALID: buyerIdentity.phone",e.BuyerIdentityEmailRequired="BUYER_IDENTITY_EMAIL_REQUIRED",e.BuyerIdentityEmailInvalid="INVALID: buyerIdentity.email",e.DeliveryFirstNameInvalid="DELIVERY_FIRST_NAME_INVALID",e.DeliveryFirstNameRequired="DELIVERY_FIRST_NAME_REQUIRED",e.DeliveryFirstNameContainsEmojis="ADDRESS_FIELD_CONTAINS_EMOJIS: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.firstName",e.DeliveryFirstNameTooLong="ADDRESS_FIELD_IS_TOO_LONG: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.firstName",e.DeliveryFirstNameContainsUrl="ADDRESS_FIELD_CONTAINS_URL: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.firstName",e.DeliveryFirstNameContainsHtmlTags="ADDRESS_FIELD_CONTAINS_HTML_TAGS: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.firstName",e.DeliveryLastNameInvalid="DELIVERY_LAST_NAME_INVALID",e.DeliveryLastNameRequired="DELIVERY_LAST_NAME_REQUIRED",e.DeliveryLastNameContainsEmojis="ADDRESS_FIELD_CONTAINS_EMOJIS: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.lastName",e.DeliveryLastNameTooLong="ADDRESS_FIELD_IS_TOO_LONG: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.lastName",e.DeliveryLastNameContainsUrl="ADDRESS_FIELD_CONTAINS_URL: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.lastName",e.DeliveryLastNameContainsHtmlTags="ADDRESS_FIELD_CONTAINS_HTML_TAGS: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.lastName",e.DeliveryAddress1Required="DELIVERY_ADDRESS1_REQUIRED",e.DeliveryAddress1Invalid="DELIVERY_ADDRESS1_INVALID",e.DeliveryAddress1TooLong="ADDRESS_FIELD_IS_TOO_LONG: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.address1",e.DeliveryAddress1ContainsHtmlTags="ADDRESS_FIELD_CONTAINS_HTML_TAGS: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.address1",e.DeliveryAddress1ContainsEmojis="ADDRESS_FIELD_CONTAINS_EMOJIS: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.address1",e.DeliveryAddress2Required="DELIVERY_ADDRESS2_REQUIRED",e.DeliveryAddress2Invalid="DELIVERY_ADDRESS2_INVALID",e.DeliveryAddress2TooLong="ADDRESS_FIELD_IS_TOO_LONG: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.address2",e.DeliveryAddress2ContainsHtmlTags="ADDRESS_FIELD_CONTAINS_HTML_TAGS: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.address2",e.DeliveryAddress2ContainsEmojis="ADDRESS_FIELD_CONTAINS_EMOJIS: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.address2",e.DeliveryAddress2AddressFieldRequired="ADDRESS_FIELD_IS_REQUIRED: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.address2",e.DeliveryCityRequired="DELIVERY_CITY_REQUIRED",e.DeliveryCityInvalid="DELIVERY_CITY_INVALID",e.DeliveryCityTooLong="ADDRESS_FIELD_IS_TOO_LONG: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.city",e.DeliveryCityContainsHtmlTags="ADDRESS_FIELD_CONTAINS_HTML_TAGS: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.city",e.DeliveryCityContainsEmojis="ADDRESS_FIELD_CONTAINS_EMOJIS: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.city",e.DeliveryCityAddressFieldRequired="ADDRESS_FIELD_IS_REQUIRED: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.city",e.DeliveryZoneNotFound="DELIVERY_ZONE_NOT_FOUND",e.DeliveryZoneRequiredForCountry="DELIVERY_ZONE_REQUIRED_FOR_COUNTRY",e.DeliveryPostalCodeInvalid="DELIVERY_POSTAL_CODE_INVALID",e.DeliveryInvalidPostalCodeForZone="DELIVERY_INVALID_POSTAL_CODE_FOR_ZONE",e.DeliveryInvalidPostalCodeForCountry="DELIVERY_INVALID_POSTAL_CODE_FOR_COUNTRY",e.DeliveryPostalCodeRequired="DELIVERY_POSTAL_CODE_REQUIRED",e.DeliveryZipInvalidForCountry="INVALID_ZIP_CODE_FOR_COUNTRY: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.zip",e.DeliveryPostalCodeContainsEmojis="ADDRESS_FIELD_CONTAINS_EMOJIS: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.zip",e.DeliveryPostalCodeAddressFieldRequired="ADDRESS_FIELD_IS_REQUIRED: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.zip",e.DeliveryCountryInvalid="INVALID: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.country",e.DeliveryPhoneNumberRequired="DELIVERY_PHONE_NUMBER_REQUIRED",e.DeliveryPhoneNumberInvalid="DELIVERY_PHONE_NUMBER_INVALID",e.DeliveryPhoneDoesNotMatchExpectedPattern="ADDRESS_FIELD_DOES_NOT_MATCH_EXPECTED_PATTERN: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.phone",e.MerchandiseOutOfStock="MERCHANDISE_OUT_OF_STOCK",e.InvalidQuantity="INVALID: input.lines.0.quantity",e.UnacceptablePaymentsAmount="PAYMENTS_UNACCEPTABLE_PAYMENT_AMOUNT",e.DeliveryNotAvailable="DELIVERY_NO_DELIVERY_AVAILABLE",e.PendingDeliveryGroups="PENDING_DELIVERY_GROUPS",e.InvalidPaymentAmount="INVALID_PAYMENT: payment.amount",e.InvalidPaymentApplePayBillingAddress="INVALID_PAYMENT: payment.walletPaymentMethod.applePayWalletContent.billingAddress",e))(p||{});const Br="https://monorail-edge.shopifysvc.com",Ur="/v1/produce";function zr(){if(typeof crypto<"u"&&crypto&&typeof crypto.randomUUID=="function")return crypto.randomUUID();const e=new Array(36);for(let t=0;t<36;t++)e[t]=Math.floor(Math.random()*16);return e[14]=4,e[19]=e[19]&=-5,e[19]=e[19]|=8,e[8]=e[13]=e[18]=e[23]="-",e.map(t=>t.toString(16)).join("")}function Hr(e){const t={"Content-Type":"application/json; charset=utf-8","X-Monorail-Edge-Event-Created-At-Ms":(e&&e.eventCreatedAtMs||Date.now()).toString(),"X-Monorail-Edge-Event-Sent-At-Ms":Date.now().toString(),"X-Monorail-Edge-Client-Message-Id":(e&&e.clientMessageId||zr()).toString()};return e&&e.userAgent&&(t["User-Agent"]=e.userAgent),e&&e.remoteIp&&(t["X-Forwarded-For"]=e.remoteIp),t}async function qr({endpoint:e,event:t,keepalive:r}){return fetch(e!=null?e:Br+Ur,{method:"post",headers:Hr(t.metadata),body:JSON.stringify({schema_id:t.schemaId,payload:t.payload}),keepalive:r})}var T=(e=>(e.Decelerated="portable_wallets_decelerated",e.InitCompleted="portable_wallets_init_completed",e.InstrumentLoadTime="portable_wallets_instrument_load_time",e.InstrumentLoadTimeFromPageLoad="portable_wallets_instrument_load_time_from_page_load",e.InstrumentLoadNotEligible="portable_wallets_instrument_load_not_eligible",e.MonorailProduceError="portable_wallets_monorail_produce_error",e.SheetClicked="portable_wallets_sheet_clicked",e.SheetCancelled="portable_wallets_sheet_cancelled",e.SheetFailed="portable_wallets_sheet_failed",e.AuthorizationAttempt="portable_wallets_authorization_attempt",e.AuthorizationComplete="portable_wallets_authorization_complete",e.CartTokenMissing="portable_wallets_cart_token_missing",e.GooglePayNotEligibleWebview="portable_wallets_google_pay_not_eligible_webview",e.WalletConfigDeveloperError="portable_wallets_wallet_config_developer_error",e.LegacyCartCookie="portable_wallets_legacy_cart_cookie",e))(T||{}),J=(e=>(e.InstrumentSdkLoaded="portable_wallets_instrument_sdk_loaded",e.InstrumentSdkFailed="portable_wallets_instrument_sdk_failed",e.InstrumentSdkEligible="portable_wallets_instrument_sdk_eligible",e.InstrumentSdkNotEligible="portable_wallets_instrument_sdk_not_eligible",e))(J||{});const jr=["Chrome-Lighthouse"];function Wr(){const e=navigator.userAgent;return jr.some(t=>e.includes(t))}async function Kr(e){if(Wr())return;b.leaveBreadcrumb("monorail event produced to ".concat(e.schemaId),e);let t;try{t=await qr({event:e})}catch(r){}if(!(t!=null&&t.ok))try{E.counter({name:T.MonorailProduceError,value:1,attributes:{schemaId:e.schemaId}})}catch(r){}}const xt="shopify_wallet_checkout_track/6.2";async function R(e){var t,r,n,a,i,o,s;let c=null;try{const l=await Vr();if(c={schemaId:xt,payload:{app_name:"storefront",page_type:Or(),checkout_one:!0,event:e.event,event_subtype:e.eventSubtype,checkout_token:e.checkoutToken,instrument_id:e.instrumentId,ttl:e.ttl,error_reason:e.errorReason,uniq_token:(t=l==null?void 0:l.uniqToken)!=null?t:"",visit_token:(r=l==null?void 0:l.visitToken)!=null?r:"",micro_session_id:(n=l==null?void 0:l.microSessionId)!=null?n:"",micro_session_count:(a=l==null?void 0:l.microSessionCount)!=null?a:0,shop_id:(i=l==null?void 0:l.shopId)!=null?i:0,theme_id:l==null?void 0:l.themeId,theme_city_hash:(o=l==null?void 0:l.themeCityHash)!=null?o:"",content_language:(s=l==null?void 0:l.contentLanguage)!=null?s:"",referer:l==null?void 0:l.referer}},!(e!=null&&e.event)){b.notify(new Error("Event is required"),{metadata:{request:{monorail:{schemaId:xt,payload:JSON.stringify(c)}}}});return}await Kr(c)}catch(l){b.notify(new Error("Failed to send monorail event: ".concat(l)),{metadata:{request:{monorail:{payload:JSON.stringify(c!=null?c:e)}}}})}}async function Vr(){var e,t,r,n,a;return(t=(e=window==null?void 0:window.ShopifyAnalytics)==null?void 0:e.lib)!=null&&t.trekkie||await new Promise(i=>{const o=setInterval(()=>{var c,l;(l=(c=window==null?void 0:window.ShopifyAnalytics)==null?void 0:c.lib)!=null&&l.trekkie&&(clearInterval(o),i())},100),s=setTimeout(()=>{clearInterval(o),clearTimeout(s),i()},7e3)}),(a=(n=(r=window.ShopifyAnalytics)==null?void 0:r.lib)==null?void 0:n.trekkie)==null?void 0:a.defaultAttributes}var v=(e=>(e.BuyItNow="BuyItNow",e.MoreOptions="MoreOptions",e.ApplePay="ApplePay",e.PayPal="PayPal",e.Venmo="Venmo",e.GooglePay="GooglePay",e.ShopPay="ShopPay",e.MetaPay="FacebookPay",e.BuyWithPrime="BuyWithPrime",e.AmazonPay="AmazonPay",e))(v||{}),N=(e=>(e.CartInitCalled="portable_wallets_cart_init_called",e.ClickSheetCancelled="portable_wallets_instrument_click_sheet_cancelled",e.ClickSheetFailed="portable_wallets_instrument_click_sheet_failure",e.ClickSheetSuccess="portable_wallets_instrument_click_sheet_success",e.SheetFailed="portable_wallets_instrument_sheet_failed",e.AuthorizationAttempt="portable_wallets_authorization_attempt",e.AuthorizationComplete="portable_wallets_authorization_complete",e.InitCalled="portable_wallets_init_called",e.InitFailed="portable_wallets_init_failed",e.InitSuccess="portable_wallets_init_success",e.UpdateFailed="portable_wallets_instrument_update_failed",e.InstrumentLoaded="portable_wallets_instrument_loaded",e.InstrumentLoadFailed="portable_wallets_instrument_load_failed",e))(N||{});function Gr(e){const t=r=>{r.persisted&&(e(),window.removeEventListener("pageshow",t))};window.addEventListener("pageshow",t)}class Yr extends Error{constructor(t){super("[".concat(t.name,"] ").concat(t.message)),this.stack=t.stack,this.name="HandleCreateCartError"}}async function ee({element:e,instrumentName:t,dataSource:r,willHandleErrorCodes:n}){try{const a=await r.getCart(),{cart:i,errors:o}=a;if(Gr(()=>{e&&(e.disabled=!1)}),!i||!i.id)throw new Error("[".concat(t,"] received invalid cart"));if(!i.checkoutUrl)throw new Error("[".concat(t,"] Created cart with no checkout URL"));if(o.length>0&&!(n!=null&&n(o)))throw new Error("Failed to create cart: ".concat(JSON.stringify(o)));const s=o.length===1&&o[0]===p.InvalidQuantity&&i.lineItems.every(c=>c.quantity===0);return I(w({},a),{outOfStock:s})}catch(a){throw new Yr(a)}finally{e.disabled=!1}}class Qr extends He{constructor(){super(),d(this,"anchor"),d(this,"i18n"),d(this,"dataSource"),d(this,"classNames"),d(this,"setI18n"),d(this,"setDataSource"),d(this,"setClassNames"),[this.i18n,this.setI18n]=M(),[this.dataSource,this.setDataSource]=M(),[this.classNames,this.setClassNames]=M()}static get observedAttributes(){return["disabled"]}connectedCallback(){this.anchor||this.render()}attributeChangedCallback(t,r,n){r!==n&&t==="disabled"&&this.anchor&&(n===""?this.anchor.setAttribute("aria-disabled","true"):this.anchor.removeAttribute("aria-disabled"),this.setAccessibilityAttributes())}async handleClick(t){if(t.preventDefault(),this.disabled||!this.anchor)return;this.disabled=!0;const[r,n]=await Promise.all([this.i18n,this.dataSource]);try{const{outOfStock:a,cart:i}=await ee({element:this,instrumentName:v.MoreOptions,dataSource:n,willHandleErrorCodes(s){return s.length===1&&s[0]===p.InvalidQuantity}});if(a){Se(r);return}const o=this.recommendedInstrument===v.ShopPay?"skip_shop_pay":"allow_redirect";Z(i.checkoutUrl,o)}catch(a){b.notify(a),q(r.translate("error_dialogs.checkout.title"),r.translate("error_dialogs.checkout.generic_error"))}}async render(){const t=await this.i18n,r=await this.classNames;this.anchor=document.createElement("a"),this.anchor.textContent=t.translate("more_payment_options"),this.anchor.className=r,this.anchor.setAttribute("id","more-payment-options-link"),this.anchor.onclick=a=>this.handleClick(a),this.setAccessibilityAttributes(),this.appendChild(this.anchor);const n=document.createElement("style");n.textContent=Mr,this.appendChild(n)}setAccessibilityAttributes(){this.anchor&&(this.disabled?(this.anchor.removeAttribute("href"),this.anchor.role="link"):(this.anchor.removeAttribute("role"),this.anchor.href="#"))}}class dn extends HTMLElement{constructor(){super(),d(this,"i18n"),d(this,"apiClient"),d(this,"setI18n"),d(this,"setApiClient"),[this.i18n,this.setI18n]=M(),[this.apiClient,this.setApiClient]=M()}}const Jr="#buyer-consent{margin-top:1em}#buyer-consent-button{background:none;border:none;padding:0;text-decoration:underline;font-size:inherit;cursor:pointer}#buyer-consent-button:before{box-shadow:none}";class un extends dn{connectedCallback(){this.innerHTML="",this.render()}async render(){const t=await this.i18n,r=await this.apiClient,n=document.createElement("p");n.setAttribute("id","buyer-consent");const a=document.createElement("buyer-consent-button");a.setI18n(t),a.setApiClient(r),n.innerHTML=t.translate("subscriptions.buyer_consent",{subscriptionPolicyLink:'<span id="subscription-policy-button"></span>'}),n.querySelector("#subscription-policy-button").appendChild(a);const i=document.createElement("style");i.textContent=Jr;const o=new DocumentFragment;o.appendChild(i),o.appendChild(n),this.appendChild(o)}}class Xr extends dn{constructor(){super(...arguments),d(this,"isFetchingPolicy",!1),d(this,"policy")}connectedCallback(){this.render()}async render(){const t=await this.i18n,r=ze();r.setAttribute("id","buyer-consent-button"),r.textContent=t.translate("subscriptions.cancellation_policy"),r.onclick=this.onClick.bind(this),this.appendChild(r)}async onClick(t){t.preventDefault();const r=await this.i18n,n=await this.apiClient;if(!this.isFetchingPolicy){if(this.policy){this.showPolicy(this.policy,r);return}try{await this.fetchSubscriptionPolicy(n);const a=this.policy&&this.policy!==""?this.policy:r.translate("subscriptions.policy_not_found");this.showPolicy(a,r)}catch(a){b.notify(a),this.showPolicy(r.translate("subscriptions.policy_not_found"),r)}}}async fetchSubscriptionPolicy(t){this.isFetchingPolicy=!0,this.policy=await t.fetchSubscriptionPolicy(),this.isFetchingPolicy=!1}showPolicy(t,r){cn(r.translate("subscriptions.subscription_policy"),t)}}x("buyer-consent-button",Xr,{isChildCustomElement:!0}),x("buyer-consent",un);var L=(e=>(e.ButtonDisplay="buttonDisplay",e.LoadInstrument="loadInstrument",e.LoadSdk="loadSDK",e.AuthorizationLatency="authorizationLatency",e))(L||{});function hn(){var e,t;return!!((e=window.performance)!=null&&e.mark)&&!!((t=window.performance)!=null&&t.measure)}function qe(e,t){return je(e,t),()=>X(e,t)}function je(e,t){hn()&&window.performance.mark("".concat(e,"-").concat(t,"-start"))}function X(e,t){var r,n;if(hn())try{const a="".concat(e,"-").concat(t,"-start"),i="".concat(e,"-").concat(t,"-end"),o="".concat(e,"-").concat(t,"-duration");window.performance.mark(i);const s=(n=window.performance.measure(o,a,i))!=null?n:(r=window.performance.getEntriesByName(o,"measure"))==null?void 0:r[0],c=s==null?void 0:s.duration;if(c==null){b.notify(new Ft("Could not measure performance of ".concat(e," ").concat(t)),{severity:"warning"});return}return c}catch(a){a instanceof SyntaxError||b.notify(new Ft("An error occurred when attempting to measure benchmark duration ".concat(e," with context ").concat(t,": ").concat(a)));return}}class Ft extends Error{constructor(){super(...arguments),d(this,"name","BenchmarkError")}}const Zr={[_.Checkout]:"bwp_checkout_widget_click",[_.CartAjax]:"bwp_cart_widget_click",[_.CartPage]:"bwp_cart_widget_click",[_.ProductPage]:"bwp_widget_click",[_.Unknown]:"bwp_widget_click"};function ea({apiClientId:e,cart:t,pageType:r}){var n;if(!((n=window.Shopify)!=null&&n.analytics))return;const a=r&&Zr[r]||"bwp_widget_click";window.Shopify.analytics.publish(a,ta(t),{sendTo:e})}function ta(e){return e?{lineItems:e.lineItems.map(({quantity:t,totalAmount:r})=>({quantity:t,totalAmount:r})),totalAmount:e.totalAmount}:{}}function na(){R({event:N.InitCalled})}function ra(e){var t,r;const n="error"in e?"failed":e.result,a="error"in e&&wa(e.error)?"[".concat(e.error.name,"]: ").concat(e.error.code):"eventType"in e&&e.eventType||void 0;R({event:n==="success"?N.InitSuccess:N.InitFailed,eventSubtype:a}),E.counter({name:T.InitCompleted,value:1,attributes:{result:n,eventType:a,recoveredFailure:!!((r=(t=window.Shopify)==null?void 0:t.PaymentButton)!=null&&r.failedToLoad)}})}function aa({instrumentOrComponentName:e,result:t,measurement:r}){R({event:t==="success"?N.InstrumentLoaded:N.InstrumentLoadFailed,instrumentId:e,ttl:r}),r!=null&&(E.histogram({name:T.InstrumentLoadTime,value:r,attributes:{instrument:e},unit:"ms"}),E.histogram({name:T.InstrumentLoadTimeFromPageLoad,value:window.performance.now(),attributes:{instrument:e},unit:"ms"}))}function ia({instrument:e,measurement:t,result:r}){const n=r==="success"?J.InstrumentSdkLoaded:J.InstrumentSdkFailed;R({event:n,instrumentId:e,ttl:t,errorReason:r==="success"?void 0:r}),t!=null&&E.histogram({name:J.InstrumentSdkLoaded,value:t,attributes:{instrument:e,result:r},unit:"ms"})}function oa({instrument:e,result:t,reason:r}){const n=t==="success"?J.InstrumentSdkEligible:J.InstrumentSdkNotEligible;R({event:n,instrumentId:e}),E.counter({name:J.InstrumentSdkEligible,value:1,attributes:{instrument:e,reason:r,result:t}})}function sa({instrument:e,reason:t}){E.counter({name:T.InstrumentLoadNotEligible,value:1,attributes:{instrument:e,reason:t}})}function la({instrument:e,result:t,checkoutToken:r,webPixelMetaData:n}){R({event:t==="success"?N.ClickSheetSuccess:N.ClickSheetFailed,checkoutToken:r,instrumentId:e}),E.counter({name:T.SheetClicked,value:1,attributes:{instrument:e,result:t}}),e===v.BuyWithPrime&&n&&ea(n)}function ca(e,t){R({event:"".concat(N.UpdateFailed,"-").concat(t),instrumentId:e})}function da(e){R({event:N.ClickSheetCancelled,instrumentId:e}),E.counter({name:T.SheetCancelled,value:1,attributes:{instrument:e}})}function ua(e,t){R({event:N.SheetFailed,instrumentId:e,errorReason:t==null?void 0:t.message}),E.counter({name:T.SheetFailed,value:1,attributes:{instrument:e}})}function ha(e){R({event:N.AuthorizationAttempt,instrumentId:e}),E.counter({name:T.AuthorizationAttempt,value:1,attributes:{instrument:e}})}function pa({instrument:e,measurement:t,result:r}){R({event:N.AuthorizationComplete,eventSubtype:r,ttl:t,instrumentId:e}),t!=null&&E.histogram({name:T.AuthorizationComplete,value:t,attributes:{instrument:e,result:r},unit:"ms"})}function ma({instrument:e,reason:t}){E.counter({name:T.Decelerated,value:1,attributes:{instrument:e,reason:t}}),E.exportMetrics()}function ya({reason:e}){E.counter({name:T.CartTokenMissing,value:1,attributes:{reason:e}})}function ga(){E.counter({name:T.WalletConfigDeveloperError,value:1})}function fa(){E.counter({name:T.LegacyCartCookie,value:1})}function ba(){window.setInterval(()=>{E.exportMetrics()},1e3)}function wa(e){return(e==null?void 0:e.name)===Ee.name}const y={initStarted:S(na),initCompleted:S(ra),instrumentLoaded:S(aa),instrumentLoadNotEligible:S(sa),instrumentSDKLoaded:S(ia),instrumentSDKEligible:S(oa),sheetClicked:S(la),sheetCancelled:S(da),sheetFailed:S(ua),updateFailed:S(ca),authorizationAttempt:S(ha),authorizationComplete:S(pa),startExporter:S(ba),decelerated:S(ma),cartTokenMissing:S(ya),walletConfigDeveloperError:S(ga),legacyCartCookie:S(fa)};function S(e){return(...t)=>{try{e(...t)}catch(r){b.notify(r)}}}function vt(e,t,r){if(we!=null&&we.length){const n=we.join(",");e.querySelectorAll(n).forEach(a=>{r===null?a.removeAttribute(t):a.setAttribute(t,r)})}}function Ca(e,t){try{const r=JSON.parse(e!=null?e:"[]");if(!(r instanceof Array))throw new Error("[".concat(t,"] invalid walletConfigs found"));return r}catch(r){throw new Error("[".concat(t,"] Error while parsing walletConfigs JSON: ").concat(r))}}function va(e,t){try{return e?JSON.parse(e):null}catch(r){throw new Error("[".concat(t,"] Error while parsing walletConfig JSON: ").concat(r))}}function At(e){var t;const r=e==null?void 0:e.getLoadEligibility();return r!=null&&r.eligible||y.instrumentLoadNotEligible({instrument:e==null?void 0:e.getInstrumentName(),reason:r==null?void 0:r.reason}),(t=r==null?void 0:r.eligible)!=null?t:!1}function Aa(e){return e.filter(At)}async function ot({walletInstrument:e,instanceNumber:t}){const r=e.getInstrumentName(),n=qe(L.LoadSdk,"".concat(r,":").concat(t));try{await e.loadWalletSDK(),y.instrumentSDKLoaded({instrument:r,measurement:n(),result:"success"})}catch(i){return b.notify(i),y.instrumentSDKLoaded({instrument:r,measurement:n(),result:"failed"}),null}let a;try{a=e.getPartnerSDKEligibility()}catch(i){b.notify(i),a={eligible:!1,reason:"uncaught exception"}}return a.eligible?(y.instrumentSDKEligible({instrument:r,result:"success"}),e):(y.instrumentSDKEligible({instrument:r,reason:a.reason,result:"failed"}),null)}class _t extends He{constructor(){super(...arguments),d(this,"apiClient"),d(this,"i18n")}get shopId(){return this.getAttribute("shop-id")}get cartId(){return this.getAttribute("cart-id")}get walletConfigs(){return this.getAttribute("wallet-configs")}get recommendedWallet(){return this.getAttribute("recommended")}get fallbackWallet(){return this.getAttribute("fallback")}get variantParams(){var t;try{return JSON.parse((t=this.getAttribute("variant-params"))!=null?t:"[]")}catch(r){throw new Ee({code:"invalid-variant-params",message:"variant-params must be a valid JSON string. Received variant-params: ".concat(this.getAttribute("variant-params"),", received error: ").concat(r)})}}triggerLoadedEvent(){document.dispatchEvent(new Event("shopify:payment_button:loaded",{bubbles:!0,cancelable:!0}))}async attributeChangedCallback(t,r,n){r!==n&&vt(this,t,n)}toggleBuyerConsent(t,r,n){if(this.hasSellingPlan){const i=document.createElement("buyer-consent");i.setI18n(n),i.setApiClient(r),t.appendChild(i);return}const a=document.querySelector("buyer-consent");a&&t.contains(a)&&a.remove()}}x("buyer-consent",un,{isChildCustomElement:!0});const ge=Element.prototype;function Et(e){const t=St(e);return pn(t)}function pn(e){var t;const r=e==null?void 0:e.elements;if(!r)return null;const n=Te(r,"id");if(!n||isNaN(Number(n)))return null;const a=Number((t=Te(r,"quantity"))!=null?t:"1"),i="gid://shopify/ProductVariant/".concat(n),o=Te(r,"selling_plan"),s=o?"gid://shopify/SellingPlan/".concat(o):void 0,c=Ea(e);return{variantId:n,quantity:a,merchandiseId:i,sellingPlanId:s,lineItemProperties:c}}function St(e){const t=$t(e,"[data-shopify='payment-button']")||document.querySelector("[data-shopify='payment-button']");return $t(t,"form")}function _a(e){const t=e==null?void 0:e.elements;return t?!!Te(t,"selling_plan"):!1}function Ea(e){if(!e)return{};const t=document.querySelectorAll('[name^="properties"][form^="'.concat(CSS.escape(e.getAttribute("id")||""),'"]')),r=e.querySelectorAll('[name^="properties"]'),n=[...t,...r],a={};return n.forEach(i=>{const o=Sa(i),s=Pa(i);o&&typeof s<"u"&&(a[o]=s)}),a}function Sa(e){const t=e.getAttribute("name");if(t===null)return null;const r=t.indexOf("["),n=t.lastIndexOf("]");return r===-1||n===-1?null:t.substring(r+1,n)}function Pa(e){if(!(["radio","checkbox"].includes(e.type)&&!e.checked)&&!(e.value===""||typeof e.value>"u"))return e.value}function Te(e,t){var r;const n=e.namedItem(t);return n&&"value"in n&&(r=n.value)!=null?r:null}function $t(e,t){if(ge.matches=ge.matches||ge.webkitMatchesSelector||ge.msMatchesSelector||ge.mozMatchesSelector,!e||e.matches(t))return e;let r=e;for(;r&&r!==document.body;)if(r=r.parentElement,r&&r.matches(t))return r;return null}class mn{constructor(t,r){d(this,"addToCartMutationObserver"),d(this,"addToCartForm"),d(this,"addToCartButtons"),this.element=t,this.onFormChanged=r,this.addToCartMutationObserver=null,this.addToCartForm=null,this.addToCartButtons=[]}setupMutationObservers(){if(this.findAndSetAddToCartButtons(),!this.addToCartForm)return;this.syncComponentStateWithForm();const t=new MutationObserver(()=>this.reobserveOnFormChanges());this.addToCartMutationObserver=new MutationObserver(()=>this.syncComponentStateWithForm()),t.observe(this.addToCartForm,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),this.observeAddToCartButtons()}syncComponentStateWithForm(){if(!this.addToCartForm){this.onFormChanged({disabled:!0,hasSellingPlan:!1});return}const t=pn(this.addToCartForm),r=!!(this.addToCartButtons.length>0&&this.addToCartButtons.every(n=>n.hasAttribute("disabled")||n.getAttribute("aria-disabled")==="true"));this.onFormChanged({disabled:r||t===null,hasSellingPlan:_a(this.addToCartForm),variantId:t==null?void 0:t.variantId,sellingPlanId:t==null?void 0:t.sellingPlanId})}observeAddToCartButtons(){this.addToCartButtons.forEach(t=>{this.addToCartMutationObserver.observe(t,{attributes:!0})})}reobserveOnFormChanges(){var t;(t=this.addToCartMutationObserver)==null||t.disconnect(),this.findAndSetAddToCartButtons(),this.observeAddToCartButtons(),this.syncComponentStateWithForm()}findAndSetAddToCartButtons(){this.addToCartForm=St(this.element),this.addToCartForm&&(this.addToCartButtons=[...this.addToCartForm.querySelectorAll("[type=submit]")])}}function Ia(e,t,r){try{const n=JSON.parse(e!=null?e:"{}"),a=JSON.parse(t!=null?t:JSON.stringify({name:"buy_it_now",wallet_params:{}}));if(n===null||Object.keys(n).length===0){if(!(a instanceof Object))throw new Error("[".concat(r,"] Invalid fallback wallet configs JSON"));return{recommendedWallet:null,fallbackWallet:a}}return{recommendedWallet:n,fallbackWallet:a}}catch(n){throw n instanceof SyntaxError?(y.walletConfigDeveloperError(),new Ee({code:"invalid-recommended-fallback-json",message:"recommended / fallback must be valid JSON"})):new Error("[".concat(r,"] Error while parsing recommended/fallback JSON: ").concat(n))}}const Da=70;class Ce{constructor(t,r,n,a){d(this,"red"),d(this,"green"),d(this,"blue"),d(this,"opacity"),this.red=t||0,this.green=r||0,this.blue=n||0,this.opacity=typeof a>"u"?1:a}getLuminance(){const t=this.red&255,r=this.green&255,n=this.blue&255;return t*.2126+r*.7152+n*.0722}isDark(){return this.opacity===0?!1:this.getLuminance()/this.opacity<Da}blendWith(t,r){this.opacity=1-(1-t.opacity)*(1-r.opacity),this.red=this.blend(t.red,r.red,t,r),this.green=this.blend(t.green,r.green,t,r),this.blue=this.blend(t.blue,r.blue,t,r)}blend(t,r,n,a){return Math.round(t*n.opacity/this.opacity+r*a.opacity*(1-n.opacity)/this.opacity)}}function Ta(e){const t=[...e];let r=new Ce(0,0,0,0),n=new Ce(255,255,255,1),a=t.shift();for(;a;)r.opacity>0&&a.opacity>0?(n=new Ce(0,0,0,0),n.blendWith(a,r)):a.opacity>0?n=a:n=r,r=n,a=t.shift();return n}const st=new Ce(255,255,255,1);function ka(e){const t=[];let r=e;for(;r.parentElement;){r=r.parentElement;const n=window.getComputedStyle(r).backgroundColor,a=Na(n);if(n&&t.push(a),a.opacity===1)break}try{return Ta(t.reverse())}catch(n){return b.notify(new Error("[BackgroundDetection] Failed to blend colors for element ".concat(e.outerHTML))),st}}function Na(e){if(!e)return st;try{const t=e.split("(")[1].split(")")[0].replace(" ","").split(",");return new Ce(Number(t[0]),Number(t[1]),Number(t[2]),typeof t[3]>"u"?1:Number(t[3]))}catch(t){b.notify(new Error("[BackgroundDetection] Failed to convert rgbString to array ".concat(e)))}return st}class te extends He{constructor(){super(),d(this,"i18n"),d(this,"dataSource"),d(this,"apiClient"),d(this,"classNames"),d(this,"containerInstanceNumber"),d(this,"onRendered"),d(this,"setI18n"),d(this,"setDataSource"),d(this,"setApiClient"),d(this,"setClassNames"),d(this,"setContainerInstanceNumber"),d(this,"parsedWalletParams"),this.onRendered=()=>{},[this.i18n,this.setI18n]=M(),[this.dataSource,this.setDataSource]=M(),[this.apiClient,this.setApiClient]=M(),[this.classNames,this.setClassNames]=M(),[this.containerInstanceNumber,this.setContainerInstanceNumber]=M()}async cleanupOnFailure(t,r){var n;try{await t()}catch(a){b.notify(new La("An error occurred requiring cleanup when attempting to a render the ".concat(r," instrument : ").concat(a)));const i=await this.containerInstanceNumber;y.instrumentLoaded({instrumentOrComponentName:r,result:"failed",measurement:X(L.ButtonDisplay,"".concat(r,":").concat(i))}),(n=this.parentElement)==null||n.remove()}}attributeChangedCallback(t,r,n,a){r!==n&&t==="disabled"&&a&&(n===""?(a.setAttribute("aria-disabled","true"),a.setAttribute("disabled","")):(a.removeAttribute("aria-disabled"),a.removeAttribute("disabled")))}get pageType(){return this.getAttribute("page-type")||_.Unknown}get buttonTheme(){return ka(this).isDark()?"LIGHT":"DARK"}get walletParams(){var t;if(this.parsedWalletParams===void 0)try{this.parsedWalletParams=JSON.parse((t=this.getAttribute("wallet-params"))!=null?t:"{}")}catch(r){throw new Error("Error while parsing wallet-params JSON: ".concat(r))}return this.parsedWalletParams}}class La extends Error{constructor(){super(...arguments),d(this,"name","CleanupOnFailureError")}}class Ra extends te{constructor(){super(...arguments),d(this,"name",v.BuyItNow),d(this,"button",null)}static get observedAttributes(){return["disabled"]}connectedCallback(){this.cleanupOnFailure(this.render.bind(this),this.name)}attributeChangedCallback(t,r,n){super.attributeChangedCallback(t,r,n,this.button)}async handleClick(){if(this.disabled||!this.button||this.button.getAttribute("aria-disabled"))return;this.disabled=!0;const[t,r]=await Promise.all([this.i18n,this.dataSource]);try{const{outOfStock:n,cart:a}=await ee({element:this,instrumentName:this.name,dataSource:r,willHandleErrorCodes(i){return i.length===1&&i[0]===p.InvalidQuantity}});if(y.sheetClicked({instrument:this.name,checkoutToken:Ue(a),result:"success"}),n){Se(t);return}Z(a.checkoutUrl,"allow_redirect")}catch(n){b.notify(n),y.sheetClicked({instrument:this.name,result:"failed"}),q(t.translate("error_dialogs.checkout.title"),t.translate("error_dialogs.checkout.generic_error"))}}async render(){var t;this.button||(this.button=ze());const r=await this.classNames;this.button.textContent=(await this.i18n).translate("instruments_copy.checkout.buy_now"),this.button.className=r,this.disabled&&this.button.setAttribute("aria-disabled","true"),this.button.onclick=()=>this.handleClick(),this.appendChild(this.button),(t=this.onRendered)==null||t.call(this)}}function Oa(){const e=navigator.userAgent,t=e.indexOf("Android")>-1,r=e.indexOf("Chrome/")>-1,n=parseInt((/Chrome\/([0-9]+)/.exec(e)||["0","0"])[1],10);return t&&r&&n===114}class G{constructor(t){d(this,"walletParams"),this.walletParams=t.wallet_params}static walletName(){throw new Error("Must define walletName for WalletInstrument subclass")}createWebComponent({walletContainer:t,dataSource:r,i18n:n,apiClient:a,containerInstanceNumber:i,classNames:o="",callToAction:s,pageType:c=_.ProductPage,onRendered:l=()=>{}}){var u,h,g;const m=this.getWebComponentName();x(m,this.getWebComponentClass(),{isChildCustomElement:!0});const C=document.createElement(m),f={"access-token":(u=t.accessToken)!=null?u:"","buyer-country":(h=t.buyerCountry)!=null?h:"","buyer-currency":t.buyerCurrency,"wallet-params":JSON.stringify((g=this.walletParams)!=null?g:{}),"page-type":c};try{t.disabled&&C.setAttribute("disabled",""),V(C,f),t.isShippingRequired&&C.setAttribute("requires-shipping",""),t.hasSellingPlan&&C.setAttribute("has-selling-plan","")}catch(A){const kt=A;throw kt.message.includes("setAttribute is not a function")&&Oa()?new tn({message:kt.message}):kt}return s&&C.setAttribute("call-to-action",""),C.setDataSource(r),C.setApiClient(a),C.setI18n(n),C.setClassNames(o),C.setContainerInstanceNumber(i),C.onRendered=l,C}loadWalletSDK(){return Promise.resolve()}getLoadEligibility(){return{eligible:!0}}getPartnerSDKEligibility(){return{eligible:!0}}}class xa extends G{static walletName(){return"buy_it_now"}getWebComponentName(){return"shopify-buy-it-now-button"}getInstrumentName(){return v.BuyItNow}getWebComponentClass(){return Ra}}const Fa="shopify-paypal-button[disabled]{opacity:.5;cursor:not-allowed;pointer-events:none}";async function ke(e){const{cartClient:t,instrumentName:r}=e;try{if(!e.cartId)throw new Error("[".concat(r,"] provided no cart ID when updating buyer identity"));if(!t)throw new Error("[".concat(r,"] provided invalid cart client when updating buyer identity"));return await t.updateCartBuyerIdentity(e)}catch(n){throw y.updateFailed(r,"updateBuyerIdentity"),n}}async function yn({cartId:e,totalAmount:t,paymentMethod:r,billingAddress:n,cartClient:a,instrumentName:i,abortSignal:o,hasSellingPlan:s,canUsePaymentMethodForFreeOrder:c}){try{if(!e)throw new Error("[".concat(i,"] provided no cart ID when updating payment"));if(!t)throw new Error("[".concat(i,"] provided no total amount when updating payment"));if(!r)throw new Error("[".concat(i,"] provided no apple pay wallet content when updating payment"));if(!a)throw new Error("[".concat(i,"] provided invalid cart client when updating payment"));const l={freePaymentMethod:{billingAddress:n}};return await a.updateCartPayment(e,w({amount:{amount:t.amount,currencyCode:t.currencyCode}},Number(t.amount)<=0&&!c&&!s?l:r),o)}catch(l){throw y.updateFailed(i,"updatePayment"),l}}function gn({cart:e,buyerCurrency:t,instrumentName:r}){if(!e)return!1;const n=e.totalAmount.amount;if(!n||Number(n)===0||t.toUpperCase()===e.totalAmount.currencyCode.toUpperCase())return!1;const a=new URL(e.checkoutUrl);return a.searchParams.set(ur.CURRENCY_CHANGE,"true"),y.decelerated({instrument:r,reason:"currency_changed"}),Z(a.toString()),!0}function fn(e){return window[bn(e)]}function bn(e){return"paypal-".concat(e.replace(/[^a-zA-Z0-9]/g,""))}function wn(e){if(!e)return null;const t=getComputedStyle(e).borderRadius;return t.includes("px")?parseInt(t,10):null}class $a extends te{constructor(){super(),d(this,"name",v.PayPal),d(this,"abortController"),d(this,"cartId"),d(this,"sdkButtonsComponent"),d(this,"container",null),d(this,"measurementContainer",null),d(this,"resizeObserver",null),d(this,"buttonHeight"),d(this,"rendering",!1),this.abortController=typeof AbortController=="function"&&new AbortController||null,this.resizeObserver=typeof ResizeObserver=="function"&&new ResizeObserver(t=>this.onResize(t))||null}connectedCallback(){this.cleanupOnFailure(this.render.bind(this),this.name)}async disconnectedCallback(){this.innerHTML="",await this.teardownPayPalButton(),this.resizeObserver&&this.resizeObserver.disconnect()}async teardownPayPalButton(){var t;try{await((t=this.sdkButtonsComponent)==null?void 0:t.close().catch(()=>{}))}catch(r){}finally{this.sdkButtonsComponent=void 0}}async onResize(t){var r,n;this.measurementContainer&&this.getPayPalConstrainedHeight((n=(r=t[0])==null?void 0:r.contentRect)==null?void 0:n.height)!==this.buttonHeight&&!this.rendering&&(await this.teardownPayPalButton(),this.container.innerHTML="",await this.cleanupOnFailure(this.renderFromPayPalSDK.bind(this),this.name))}async render(){var t;const r=document.createElement("style");r.innerHTML=Fa;const n=document.createElement("div"),a=document.createElement("div"),i=await this.classNames;n.className=i,a.className=i,V(n,{role:"button"}),V(a,{role:"button","aria-hidden":"true",tabindex:"-1"}),a.innerHTML="&nbsp;",Q(n,{display:"flex","max-height":"55px"}),Q(a,{display:"block",opacity:"0",visibility:"hidden","pointer-events":"none",position:"absolute","max-height":"55px"}),this.appendChild(a),this.appendChild(r),this.appendChild(n),this.container=n,this.measurementContainer=a,this.renderFromPayPalSDK(),(t=this.resizeObserver)==null||t.observe(this.measurementContainer)}async renderFromPayPalSDK(){var t,r,n;if(!this.container)throw new Error("button container not set when attempting to render");this.rendering=!0;const a=this.walletParams.paymentIntent==="TOKENIZE",i=()=>this.createToken(this.apiClient);let o,s;a?s=i:o=i;const c=async(m,C)=>{if(this.disabled)return C.reject();try{const[f,A]=await Promise.all([this.dataSource,this.i18n]),{outOfStock:kt,cart:Do}=await ee({element:this,instrumentName:this.name,dataSource:f,willHandleErrorCodes(Oo){return Oo.length===1&&Oo[0]===p.InvalidQuantity}});return kt?(Se(A),C.reject()):(this.cartId=Do.id,C.resolve())}catch(f){return f instanceof Error&&(y.sheetClicked({instrument:this.name,result:"failed"}),b.notify(f),q(l.translate("error_dialogs.checkout.title"),l.translate("error_dialogs.checkout.generic_error"))),C.reject()}},l=await this.i18n,u=this.getPayPalConstrainedHeight(this.getContainerHeight()),h=wn(this.measurementContainer),g={color:"gold",label:this.hasAttribute("call-to-action")?"pay":"paypal",height:u,shape:"sharp"};h&&h>0&&(g.borderRadius=h),this.sdkButtonsComponent=(r=(t=fn(this.walletParams.sdkUrl))==null?void 0:t.Buttons)==null?void 0:r.call(t,{fundingSource:"paypal",style:g,createOrder:o,createBillingAgreement:s,onApprove:async m=>{await this.onApprove(m)},onCancel:()=>{var m;y.sheetCancelled(this.name),(m=this.abortController)==null||m.abort()},onClick:c,onError:m=>{var C;if(m.message==="Window is closed, can not determine type"){y.sheetCancelled(this.name),(C=this.abortController)==null||C.abort();return}b.notify(m);const f=l.translate("brand.paypal");q(l.translate("error_dialogs.wallet.title",{wallet:f}),l.translate("error_dialogs.wallet.generic_error",{wallet:f}))}}),await((n=this.sdkButtonsComponent)==null?void 0:n.render(this.container)),this.rendering=!1,this.onRendered()}async createToken(t){const r=await t;try{if(!this.cartId)throw new Error("cartId not found when creating token");const n=await r.paypalTokenCreate(this.cartId);return y.sheetClicked({instrument:this.name,result:"success"}),n}catch(n){throw y.sheetClicked({instrument:this.name,result:"failed"}),n}}async onApprove({orderID:t,payerID:r}){var n,a,i;try{if(y.authorizationAttempt(this.name),je(L.AuthorizationLatency,this.name),!this.cartId)throw new Error("Cart not found");const o=await this.apiClient,s=await o.paypalBuyerDetailsFetch(t,this.cartId),{data:c}=await ke({cartId:this.cartId,cartClient:o,instrumentName:this.name,emailAddress:s.email,streetAddress:s.destinationAddress});if(!c)throw new Error("Cart not found");if(await yn({abortSignal:(n=this.abortController)==null?void 0:n.signal,cartClient:o,cartId:c.id,instrumentName:v.PayPal,billingAddress:(a=s.billingAddress)!=null?a:s.destinationAddress,paymentMethod:{walletPaymentMethod:{paypalWalletContent:{billingAddress:(i=s.billingAddress)!=null?i:s.destinationAddress,email:s.email,expiresAt:s.expiresAt,payerId:r,token:t,acceptedSubscriptionTerms:!1,vaultingAgreement:!1}}},canUsePaymentMethodForFreeOrder:!0,totalAmount:c.totalAmount}),gn({cart:c,buyerCurrency:this.buyerCurrency,instrumentName:this.name}))return;y.authorizationComplete({instrument:this.name,result:"success",measurement:X(L.AuthorizationLatency,this.name)}),Z(c.checkoutUrl)}catch(o){throw y.authorizationComplete({instrument:this.name,result:"failure",measurement:X(L.AuthorizationLatency,this.name)}),o}}getPayPalConstrainedHeight(t){if(t)return Math.min(55,Math.max(t,25))}getContainerHeight(){if(!this.measurementContainer)return this.buttonHeight;const t=this.measurementContainer.getBoundingClientRect().height;return this.buttonHeight=t,t}}const ie=class Ro extends G{static walletName(){return"paypal"}constructor(t){super(t)}getWebComponentName(){return"shopify-paypal-button"}getInstrumentName(){return v.PayPal}getWebComponentClass(){return $a}loadWalletSDK(){let t=Ro.paypalSDKPromiseByUrl.get(this.walletParams.sdkUrl);if(t)return t;const r=document.createElement("script");return r.setAttribute("src",this.walletParams.sdkUrl),t=new Promise((n,a)=>{r.setAttribute("data-namespace",bn(this.walletParams.sdkUrl)),r.onload=()=>n(),r.onerror=i=>{Ro.paypalSDKPromiseByUrl.delete(this.walletParams.sdkUrl),document.body.removeChild(r),a(i)},document.body.appendChild(r)}),Ro.paypalSDKPromiseByUrl.set(this.walletParams.sdkUrl,t),t}getLoadEligibility(){return{eligible:!0}}getPartnerSDKEligibility(){var t,r;try{return(r=(t=fn(this.walletParams.sdkUrl))==null?void 0:t.Buttons)!=null&&r.call(t).isEligible()?{eligible:!0}:{eligible:!1,reason:"PayPal SDK not eligible"}}catch(n){throw new Ee({code:"paypal-sdk-eligibility-check-failed",message:"PayPal SDK 'isEligible' method failed unexpectedly: ".concat(n)})}}};d(ie,"paypalSDKPromiseByUrl",new Map);let lt=ie;const Ma=".apple-pay-button{display:flex;align-items:center;justify-content:center;width:100%;padding:0!important;cursor:pointer;border:none}.apple-pay-button:hover:not(:disabled){filter:brightness(92%)}.apple-pay-button svg{height:100%;flex-shrink:0}.apple-pay--content{width:100%;height:100%;flex-grow:1;display:flex;align-items:center;justify-content:center;white-space:pre}.apple-pay--light{background:#fff;color:#000}.apple-pay--light svg{fill:#000}.apple-pay--dark{background:#000;color:#fff}.apple-pay--dark svg{fill:#fff}",ct={UK:"GB",JA:"JP"},Cn=["AS","GU","MP","PR","VI"];Cn.forEach(e=>{ct[e]="US"});function Ie(e){var t,r;const n=e.countryCode,a={firstName:e.givenName||void 0,lastName:e.familyName||void 0,address1:(t=e==null?void 0:e.addressLines)==null?void 0:t[0],address2:((r=e==null?void 0:e.addressLines)==null?void 0:r[1])||void 0,city:e.locality||void 0,zip:e.postalCode||void 0,province:e.administrativeArea||e.subLocality||void 0,country:Ba(e.countryCode),phone:e.phoneNumber||void 0};return a.country==="HK"&&(a.zip=void 0,a.province=e.postalCode),n&&Cn.includes(n)&&(a.province=n),a.lastName||(a.lastName=a.firstName),a}function Ba(e){if(!e)return"ZZ";const t=e.toUpperCase();return Object.keys(ct).includes(t)?ct[t]:t}function Ua(e,t){return ae({label:e,possibleLines:[t]})[0]}function za({subtotal:e,deliveryGroups:t,duties:r,taxes:n,discountAllocations:a,i18n:i,formattedRecurringTotals:o}){var s;const c=ae({label:i.translate("order_summary.subtotal"),possibleLines:[e]}),l=Ha(t,i),u=ae({label:i.translate("order_summary.duties"),possibleLines:[r]}),h=ae({label:i.translate("order_summary.taxes"),possibleLines:[n]}),g=o.map(f=>({label:f,amount:"0.00",type:"pending"})),m=g.length?[{label:i.translate("order_summary.subscriptions.recurring_total_tooltip_line"),amount:"0.00",type:"pending"}]:[],C=(s=a==null?void 0:a.flatMap(f=>{var A;const kt=(A=f.title)!=null?A:f.code;return ae({label:kt!=null?kt:i.translate("order_summary.discount"),possibleLines:[f.discountedAmount],isDiscount:!0})}))!=null?s:[];return[...c,...l,...u,...h,...C,...g,...m]}function ae({label:e,possibleLines:t,isDiscount:r=!1}){return t.filter(n=>(n==null?void 0:n.amount)!==void 0).map(n=>({label:e,amount:r?"-".concat(it(n.amount)):it(n.amount)}))}function Ha(e,t){return e.some(r=>r.groupType===ve.Subscription)?e.map(r=>({label:r.groupType===ve.Subscription?t.translate("order_summary.shipping_subscription"):t.translate("order_summary.shipping_one_time_purchase"),amount:it(r.selectedDeliveryOption.estimatedCost.amount)})):ae({label:t.translate("order_summary.shipping"),possibleLines:e.map(r=>{var n;return{amount:(n=r.selectedDeliveryOption)==null?void 0:n.estimatedCost.amount}})})}function qa(e,t){return e.map(r=>{var n;return{title:Ka(r,t),estimatedCost:{amount:Wa(r),currencyCode:r[0].estimatedCost.currencyCode},handle:Va(r),description:(n=r[0].description)!=null?n:""}})}function ja(e){return e.map(t=>t.deliveryOptions.map(r=>I(w({},r),{groupType:t.groupType}))).reduce((t,r)=>t.flatMap(n=>r.map(a=>[...n,a])),[[]])}function Wa(e){return e.reduce((t,r)=>t+Number(r.estimatedCost.amount),0).toFixed(2)}function Ka(e,t){var r,n;const a=(r=e.find(s=>s.groupType===ve.OneTimePurchase))==null?void 0:r.title,i=(n=e.find(s=>s.groupType===ve.Subscription))==null?void 0:n.title,o=[...new Set([a,i])].filter(Boolean);return o.length===2?t.translate("shipping_methods.connect_shipping_methods",{methodOne:o[0],methodTwo:o[1]}):o[0]}function Va(e){return e.map(t=>t.handle).join(",")}function Ga(e,t){if(!e.length)return[];const r=ja(e);return qa(r,t).map(n=>{var a;return{label:n.title||"",amount:n.estimatedCost.amount,identifier:n.handle,detail:(a=n.description)!=null?a:""}})}const Qe=async({paymentSheetAction:e,onProceed:t,terminateSession:r})=>{switch(e.action){case"abort":r();break;case"show_error":await t(e.errors);break;case"update":await t(e.errors);break;default:throw new Error('Missing handler for payment sheet action "'.concat(e.action,'"'))}},Ya=["abort","show_error","complete","update"];class Qa extends Error{constructor(){super(...arguments),d(this,"name","UnhandledActionError")}}class Ja{constructor(){d(this,"generatePrioritizedPaymentSheetAction",(t,r)=>{let n;const a=[],i=[],o=[],s=r.filter(l=>l!==p.UnacceptablePaymentsAmount).some(l=>t[l]!==void 0);for(const l of Object.keys(t))if(!(l===p.UnacceptablePaymentsAmount&&s)){const u=t[l]();u.effects&&i.push(...u.effects),u.action!=="complete"&&u.errors&&o.push(...u.errors),a.push(u)}const c=(l=>Ya.map(u=>l.find(h=>h.action===u)).find(u=>!!u))(a);return c&&(n=c,n.effects=i,n.action!=="complete"&&(n.errors=o)),n})}getMergedPaymentSheetAction({result:t,errorActions:r}){const n={};r.forEach(i=>{i.errors.forEach(o=>{t.errors.includes(o)&&(n[o]=i.generateAction)})});let a;for(const i of t.errors){const o=n[i];if(o){a=o();break}}return{firstPaymentSheetAction:a,prioritizedPaymentSheetAction:this.generatePrioritizedPaymentSheetAction(n,t.errors)}}getUnhandledErrors(t,r){const n=r.flatMap(a=>a.errors);return t.filter(a=>!n.includes(a))}}class Xa extends Ja{constructor(t){super(),this.i18n=t}mapMutationResultToPaymentSheetAction(t,r){var n;const a=this.mapCustomValidationFunctionErrorToAction(t.errors);if(a)return a;const i=this.getErrorActions(),o=t.errors,s=this.getUnhandledErrors(o,i);if(s.forEach(l=>{b.notify(new Qa("[".concat(v.ApplePay,"] mutation result error not handled: ").concat(l)))}),((n=t.data)==null?void 0:n.deliveryGroups.length)===0&&r!=null&&r.shippingRequired)return{action:"show_error",errors:[new ApplePayError("addressUnserviceable")]};const{firstPaymentSheetAction:c}=this.getMergedPaymentSheetAction({result:t,errorActions:i});return c||(s.length>0?{action:"abort"}:{action:"update",errors:[]})}mapCompletionResultToPaymentSheetAction(t){if(!t.data)throw new Error("[".concat(v.ApplePay,"] completion returned null result"));switch(t.data.__typename){case"SubmitSuccess":return{action:"complete",redirectUrl:t.data.redirectUrl};case"SubmitAlreadyAccepted":case"SubmitThrottled":case"SubmitFailed":{const r=this.mapCustomValidationFunctionErrorToAction(t.errors);if(r)return r;const n=this.getErrorActions(),a=t.errors;this.getUnhandledErrors(a,n).forEach(o=>{b.notify(new Error("[".concat(v.ApplePay,"] completion result error not handled: ").concat(o)))});const{prioritizedPaymentSheetAction:i}=this.getMergedPaymentSheetAction({result:t,errorActions:n});return i||{action:"abort"}}default:throw new Error("[".concat(v.ApplePay,"] unknown completion result type: ").concat(t.data.__typename))}}getErrorActions(){return[{errors:[p.InvalidLanguage],generateAction:()=>({action:"abort",effects:[()=>{b.notify(new Error("[".concat(v.ApplePay,"] mutation provided invalid language, aborting")))}]})},{errors:[p.InvalidCountry],generateAction:()=>({action:"abort",effects:[()=>{b.notify(new Error("[".concat(v.ApplePay,"] mutation provided invalid country, aborting")))}]})},{errors:[p.MissingCartId],generateAction:()=>({action:"abort",effects:[()=>{b.notify(new Error("[".concat(v.ApplePay,"] mutation provided invalid cart ID, aborting")))}]})},{errors:[p.UnacceptablePaymentsAmount],generateAction:()=>({action:"abort"})},{errors:[p.InvalidPaymentAmount],generateAction:()=>({action:"abort"})},{errors:[p.MerchandiseOutOfStock],generateAction:()=>({action:"abort"})},{errors:[p.DeliveryNotAvailable],generateAction:()=>({action:"show_error",errors:[new ApplePayError("addressUnserviceable")]})},{errors:[p.BuyerIdentityEmailRequired],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","emailAddress",this.i18n.translate("errors.missing.email"))]})},{errors:[p.DeliveryFirstNameRequired],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.missing.first_name"))]})},{errors:[p.DeliveryFirstNameInvalid],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.invalid.first_name"))]})},{errors:[p.DeliveryLastNameRequired],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.missing.last_name"))]})},{errors:[p.DeliveryLastNameInvalid],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.invalid.last_name"))]})},{errors:[p.DeliveryAddress1Required],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","addressLines",this.i18n.translate("errors.missing.address1"))]})},{errors:[p.DeliveryAddress1Invalid],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","addressLines",this.i18n.translate("errors.invalid.address1"))]})},{errors:[p.DeliveryAddress2Required,p.DeliveryAddress2AddressFieldRequired],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","addressLines",this.i18n.translate("errors.missing.address2"))]})},{errors:[p.DeliveryAddress2Invalid],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","addressLines",this.i18n.translate("errors.invalid.address2"))]})},{errors:[p.DeliveryCityRequired,p.DeliveryCityAddressFieldRequired],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","locality",this.i18n.translate("errors.missing.city"))]})},{errors:[p.DeliveryCityInvalid],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","locality",this.i18n.translate("errors.invalid.city"))]})},{errors:[p.DeliveryZoneRequiredForCountry],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","administrativeArea",this.i18n.translate("errors.missing.zone"))]})},{errors:[p.DeliveryZoneNotFound],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","administrativeArea",this.i18n.translate("errors.invalid.zone"))]})},{errors:[p.DeliveryPostalCodeRequired,p.DeliveryPostalCodeAddressFieldRequired],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","postalCode",this.i18n.translate("errors.missing.postal_code"))]})},{errors:[p.DeliveryPostalCodeInvalid,p.DeliveryInvalidPostalCodeForZone,p.DeliveryInvalidPostalCodeForCountry,p.DeliveryZipInvalidForCountry],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","postalCode",this.i18n.translate("errors.invalid.postal_code"))]})},{errors:[p.DeliveryPhoneNumberRequired],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","phoneNumber",this.i18n.translate("errors.missing.phone"))]})},{errors:[p.DeliveryPhoneNumberInvalid,p.BuyerIdentityInvalidPhone,p.DeliveryPhoneDoesNotMatchExpectedPattern],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","phoneNumber",this.i18n.translate("errors.invalid.phone"))]})},{errors:[p.BuyerIdentityInvalidCountry,p.DeliveryCountryInvalid],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","country",this.i18n.translate("errors.invalid.country"))]})},{errors:[p.InvalidPaymentApplePayBillingAddress],generateAction:()=>({action:"show_error",errors:[new ApplePayError("billingContactInvalid")]})},{errors:[p.DeliveryLastNameContainsEmojis],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.emojis.last_name"))]})},{errors:[p.DeliveryFirstNameContainsEmojis],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.emojis.first_name"))]})},{errors:[p.DeliveryAddress1TooLong],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","addressLines",this.i18n.translate("errors.too_long.address1"))]})},{errors:[p.DeliveryAddress2TooLong],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","addressLines",this.i18n.translate("errors.too_long.address2"))]})},{errors:[p.DeliveryFirstNameTooLong],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.too_long.first_name"))]})},{errors:[p.DeliveryLastNameTooLong],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.too_long.last_name"))]})},{errors:[p.DeliveryCityTooLong],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","locality",this.i18n.translate("errors.too_long.city"))]})},{errors:[p.DeliveryFirstNameContainsUrl],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.url.first_name"))]})},{errors:[p.DeliveryLastNameContainsUrl],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.url.last_name"))]})},{errors:[p.DeliveryAddress1ContainsHtmlTags],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","addressLines",this.i18n.translate("errors.html_tags.address1"))]})},{errors:[p.DeliveryAddress2ContainsHtmlTags],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","addressLines",this.i18n.translate("errors.html_tags.address2"))]})},{errors:[p.DeliveryCityContainsHtmlTags],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","locality",this.i18n.translate("errors.html_tags.city"))]})},{errors:[p.DeliveryFirstNameContainsHtmlTags],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.html_tags.first_name"))]})},{errors:[p.DeliveryLastNameContainsHtmlTags],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.html_tags.last_name"))]})},{errors:[p.DeliveryCityContainsEmojis],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","locality",this.i18n.translate("errors.emojis.city"))]})},{errors:[p.DeliveryAddress1ContainsEmojis],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","addressLines",this.i18n.translate("errors.emojis.address1"))]})},{errors:[p.DeliveryAddress2ContainsEmojis],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","addressLines",this.i18n.translate("errors.emojis.address2"))]})},{errors:[p.DeliveryPostalCodeContainsEmojis],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","postalCode",this.i18n.translate("errors.emojis.postal_code"))]})},{errors:[p.BuyerIdentityEmailInvalid],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","emailAddress",this.i18n.translate("errors.invalid.email"))]})}]}mapCustomValidationFunctionErrorToAction(t){const r=t.find(n=>typeof n=="object"&&(n==null?void 0:n.code)===nt);return r?{action:"abort",effects:[()=>{const n=this.i18n.translate("brand.apple_pay");cn(this.i18n.translate("error_dialogs.wallet.title",{wallet:n}),r.message)}]}:null}}const Mt=["name","postalAddress"];function Za({shippingRequired:e,walletParams:t,buyerCurrency:r}){const{phoneRequired:n,emailRequired:a}=t,i=[...a?["email"]:[],...n?["phone"]:[]],o=e?[...Mt,...i]:i;return{countryCode:t.countryCode,currencyCode:r,merchantCapabilities:t.merchantCapabilities,supportedNetworks:t.supportedNetworks,total:{type:"pending",label:t.merchantName,amount:"1.00"},requiredBillingContactFields:Mt,requiredShippingContactFields:o,shippingType:t.shippingType}}const ei=e=>{const t=e.lineItems.reduce((r,n)=>r+Number(n.subtotalAmount.amount),0);return{amount:String(t),currencyCode:e.totalAmount.currencyCode}},ti=e=>{const t=e.lineItems.flatMap(r=>r.discountAllocations);return[...e.discountCodes.filter(r=>r.applicable&&e.discountAllocations.findIndex(n=>n.code===r.code)===-1&&t.findIndex(n=>n.code===r.code)===-1).map(r=>({code:r.code,discountedAmount:{amount:"0",currencyCode:e.totalAmount.currencyCode}})),...e.discountAllocations,...t]};function ni(e,t){return e.reduce((r,n)=>{var a;if(!n.sellingPlanAllocation)return r;const{sellingPlanAllocation:{sellingPlan:i,priceAdjustments:o},quantity:s}=n;if(!i.recurringDeliveries||!i.billingPolicy)return r;const c=ri({billingPolicy:i.billingPolicy,i18n:t}),l=i.priceAdjustments[0].orderCount,u=o[0].price.currencyCode,h=Bt({price:Number(o[0].price.amount)*s,currencyCode:u,locale:t.locale});if(o.length===2){const g=o[1].price.currencyCode,m=Bt({price:Number((a=o[1])==null?void 0:a.price.amount)*s,currencyCode:g,locale:t.locale});return[...r,t.translate("order_summary.subscriptions.recurring_totals_with_policies",{count:l,fixedPrice:h,recurringPrice:m,interval:c})]}return[...r,t.translate("order_summary.subscriptions.recurring_totals",{fixedPrice:h,interval:c})]},[])}function Bt({price:e,currencyCode:t,locale:r}){return Intl.NumberFormat(r,{style:"currency",currency:t,currencyDisplay:"narrowSymbol"}).format(e)}function ri({billingPolicy:e,i18n:t}){const{interval:r,intervalCount:n}=e,a={YEAR:"order_summary.subscriptions.recurring_total_intervals.year",MONTH:"order_summary.subscriptions.recurring_total_intervals.month",WEEK:"order_summary.subscriptions.recurring_total_intervals.week",DAY:"order_summary.subscriptions.recurring_total_intervals.day"}[r];if(!a)throw new Error("Unknown selling plan interval provided: ".concat(r));return t.translate(a,{count:n})}const We="GraphQL Client",Ut=0,zt=3,vn="An error occurred while fetching from the API. Review 'graphQLErrors' for details.",An="Response returned unexpected Content-Type:",_n="An unknown error has occurred. The API did not return a data object or any errors in its response.",dt={json:"application/json",multipart:"multipart/mixed"},Ht="X-SDK-Variant",qt="X-SDK-Version",ai="shopify-graphql-client",ii="0.10.3",En=1e3,oi=[429,503],Sn=/@(defer)\b/i,jt="\r\n",si=/boundary="?([^=";]+)"?/i,Wt=jt+jt;function K(e,t=We){return e.startsWith("".concat(t))?e:"".concat(t,": ").concat(e)}function de(e){return e instanceof Error?e.message:JSON.stringify(e)}function Pn(e){return e instanceof Error&&e.cause?e.cause:void 0}function In(e){return e.flatMap(({errors:t})=>t!=null?t:[])}function Dn({client:e,retries:t}){if(t!==void 0&&(typeof t!="number"||t<Ut||t>zt))throw new Error("".concat(e,': The provided "retries" value (').concat(t,") is invalid - it cannot be less than ").concat(Ut," or greater than ").concat(zt))}function k(e,t){return t&&(typeof t!="object"||Array.isArray(t)||typeof t=="object"&&Object.keys(t).length>0)?{[e]:t}:{}}function Tn(e,t){if(e.length===0)return t;const r={[e.pop()]:t};return e.length===0?r:Tn(e,r)}function kn(e,t){return Object.keys(t||{}).reduce((r,n)=>(typeof t[n]=="object"||Array.isArray(t[n]))&&e[n]?(r[n]=kn(e[n],t[n]),r):(r[n]=t[n],r),Array.isArray(e)?[...e]:w({},e))}function Nn([e,...t]){return t.reduce(kn,w({},e))}function li({clientLogger:e,customFetchApi:t=fetch,client:r=We,defaultRetryWaitTime:n=En,retriableCodes:a=oi}){const i=async(o,s,c)=>{const l=s+1,u=c+1;let h;try{if(h=await t(...o),e({type:"HTTP-Response",content:{requestParams:o,response:h}}),!h.ok&&a.includes(h.status)&&l<=u)throw new Error;return h}catch(g){if(l<=u){const m=h==null?void 0:h.headers.get("Retry-After");return await ci(m?parseInt(m,10):n),e({type:"HTTP-Retry",content:{requestParams:o,lastResponse:h,retryAttempt:s,maxRetries:c}}),i(o,l,c)}throw new Error(K("".concat(c>0?"Attempted maximum number of ".concat(c," network retries. Last message - "):"").concat(de(g)),r))}};return i}async function ci(e){return new Promise(t=>setTimeout(t,e))}function di({headers:e,url:t,customFetchApi:r=fetch,retries:n=0,logger:a}){Dn({client:We,retries:n});const i={headers:e,url:t,retries:n},o=ui(a),s=li({customFetchApi:r,clientLogger:o,defaultRetryWaitTime:En}),c=hi(s,i),l=pi(c),u=Ci(c);return{config:i,fetch:c,request:l,requestStream:u}}function ui(e){return t=>{e&&e(t)}}async function Ln(e){const{errors:t,data:r,extensions:n}=await e.json();return w(w(w({},k("data",r)),k("extensions",n)),t||!r?{errors:I(w({networkStatusCode:e.status,message:K(t?vn:_n)},k("graphQLErrors",t)),{response:e})}:{})}function hi(e,{url:t,headers:r,retries:n}){return async(a,i={})=>{const{variables:o,headers:s,url:c,retries:l}=i,u=JSON.stringify({query:a,variables:o});Dn({client:We,retries:l});const h=Object.entries(w(w({},r),s)).reduce((m,[C,f])=>(m[C]=Array.isArray(f)?f.join(", "):f.toString(),m),{});!h[Ht]&&!h[qt]&&(h[Ht]=ai,h[qt]=ii);const g=[c!=null?c:t,{method:"POST",headers:h,body:u}];return e(g,1,l!=null?l:n)}}function pi(e){return async(...t)=>{if(Sn.test(t[0]))throw new Error(K("This operation will result in a streamable response - use requestStream() instead."));try{const r=await e(...t),{status:n,statusText:a}=r,i=r.headers.get("content-type")||"";return r.ok?i.includes(dt.json)?Ln(r):{errors:{networkStatusCode:n,message:K("".concat(An," ").concat(i)),response:r}}:{errors:{networkStatusCode:n,message:K(a),response:r}}}catch(r){return{errors:{message:de(r)}}}}}function mi(e){return re(this,null,function*(){const t=new TextDecoder;if(e.body[Symbol.asyncIterator])try{for(var r=B(e.body),n,a,i;n=!(a=yield new F(r.next())).done;n=!1){const o=a.value;yield t.decode(o)}}catch(o){i=[o]}finally{try{n&&(a=r.return)&&(yield new F(a.call(r)))}finally{if(i)throw i[0]}}else{const o=e.body.getReader();let s;try{for(;!(s=yield new F(o.read())).done;)yield t.decode(s.value)}finally{o.cancel()}}})}function yi(e,t){return{[Symbol.asyncIterator](){return re(this,null,function*(){try{let o="";try{for(var r=B(e),n,a,i;n=!(a=yield new F(r.next())).done;n=!1){const s=a.value;if(o+=s,o.indexOf(t)>-1){const c=o.lastIndexOf(t),l=o.slice(0,c).split(t).filter(u=>u.trim().length>0).map(u=>u.slice(u.indexOf(Wt)+Wt.length).trim());l.length>0&&(yield l),o=o.slice(c+t.length),o.trim()==="--"&&(o="")}}}catch(s){i=[s]}finally{try{n&&(a=r.return)&&(yield new F(a.call(r)))}finally{if(i)throw i[0]}}}catch(o){throw new Error("Error occured while processing stream payload - ".concat(de(o)))}})}}}function gi(e){return{[Symbol.asyncIterator](){return re(this,null,function*(){const t=yield new F(Ln(e));yield I(w({},t),{hasNext:!1})})}}}function fi(e){return e.map(t=>{try{return JSON.parse(t)}catch(r){throw new Error("Error in parsing multipart response - ".concat(de(r)))}}).map(t=>{const{data:r,incremental:n,hasNext:a,extensions:i,errors:o}=t;if(!n)return I(w(w({data:r||{}},k("errors",o)),k("extensions",i)),{hasNext:a});const s=n.map(({data:c,path:l,errors:u})=>w({data:c&&l?Tn(l,c):{}},k("errors",u)));return I(w({data:s.length===1?s[0].data:Nn([...s.map(({data:c})=>c)])},k("errors",In(s))),{hasNext:a})})}function bi(e,t){if(e.length>0)throw new Error(vn,{cause:{graphQLErrors:e}});if(Object.keys(t).length===0)throw new Error(_n)}function wi(e,t){var r;const n=(t!=null?t:"").match(si),a="--".concat(n?n[1]:"-");if(!((r=e.body)!=null&&r.getReader)&&!e.body[Symbol.asyncIterator])throw new Error("API multipart response did not return an iterable body",{cause:e});const i=mi(e);let o={},s;return{[Symbol.asyncIterator](){return re(this,null,function*(){var c,l;try{let C=!0;try{for(var u=B(yi(i,a)),h,g,m;h=!(g=yield new F(u.next())).done;h=!1){const f=g.value,A=fi(f);s=(l=(c=A.find(Do=>Do.extensions))==null?void 0:c.extensions)!=null?l:s;const kt=In(A);o=Nn([o,...A.map(({data:Do})=>Do)]),C=A.slice(-1)[0].hasNext,bi(kt,o),yield I(w(w({},k("data",o)),k("extensions",s)),{hasNext:C})}}catch(f){m=[f]}finally{try{h&&(g=u.return)&&(yield new F(g.call(u)))}finally{if(m)throw m[0]}}if(C)throw new Error("Response stream terminated unexpectedly")}catch(C){const f=Pn(C);yield I(w(w({},k("data",o)),k("extensions",s)),{errors:I(w({message:K(de(C)),networkStatusCode:e.status},k("graphQLErrors",f==null?void 0:f.graphQLErrors)),{response:e}),hasNext:!1})}})}}}function Ci(e){return async(...t)=>{if(!Sn.test(t[0]))throw new Error(K("This operation does not result in a streamable response - use request() instead."));try{const r=await e(...t),{statusText:n}=r;if(!r.ok)throw new Error(n,{cause:r});const a=r.headers.get("content-type")||"";switch(!0){case a.includes(dt.json):return gi(r);case a.includes(dt.multipart):return wi(r,a);default:throw new Error("".concat(An," ").concat(a),{cause:r})}}catch(r){return{[Symbol.asyncIterator](){return re(this,null,function*(){const n=Pn(r);yield{errors:w(w({message:K(de(r))},k("networkStatusCode",n==null?void 0:n.status)),k("response",n)),hasNext:!1}})}}}}}const vi="mutation cartCreate($input:CartInput!$country:CountryCode$language:LanguageCode$withCarrierRates:Boolean=false)@inContext(country:$country language:$language){result:cartCreate(input:$input){...@defer(if:$withCarrierRates){cart{...CartParts}errors:userErrors{...on CartUserError{message field code}}}}}",Ai="mutation cartBillingAddressUpdate($cartId:ID!$billingAddress:MailingAddressInput$country:CountryCode$language:LanguageCode$withCarrierRates:Boolean=false)@inContext(country:$country language:$language){result:cartBillingAddressUpdate(cartId:$cartId billingAddress:$billingAddress){...@defer(if:$withCarrierRates){cart{...CartParts}errors:userErrors{...on CartUserError{message field code}}}}}",_i="mutation cartBuyerIdentityUpdate($cartId:ID!$buyerIdentity:CartBuyerIdentityInput!$country:CountryCode$language:LanguageCode$withCarrierRates:Boolean=false)@inContext(country:$country language:$language){result:cartBuyerIdentityUpdate(cartId:$cartId buyerIdentity:$buyerIdentity){...@defer(if:$withCarrierRates){cart{...CartParts}errors:userErrors{...on CartUserError{message field code}}}}}",Ei="mutation cartSelectedDeliveryOptionsUpdate($cartId:ID!$selectedDeliveryOptions:[CartSelectedDeliveryOptionInput!]!$country:CountryCode=CA$language:LanguageCode=EN$withCarrierRates:Boolean=false)@inContext(country:$country language:$language){result:cartSelectedDeliveryOptionsUpdate(cartId:$cartId selectedDeliveryOptions:$selectedDeliveryOptions){...@defer(if:$withCarrierRates){cart{...CartParts}errors:userErrors{...on CartUserError{message field code}}}}}",Si="mutation applePaySessionCreate($validationUrl:URL!){applePaySessionCreate(validationUrl:$validationUrl){...@defer{applePaySession{body}}}}",Pi="mutation PayPalBuyerDetailsFetch($token:String!$cartId:ID){paypalBuyerDetailsFetch(token:$token cartId:$cartId){...@defer{paypalDetails{email expiresAt destinationAddress{...on MailingAddress{address1 address2 city company country firstName lastName phone province zip}}billingAddress{...on MailingAddress{address1 address2 city company country firstName lastName phone province zip}}}}}}",Ii="mutation PayPalTokenCreate($cartId:ID!){paypalTokenCreate(cartId:$cartId){...@defer{paypalToken{token}}}}",Di="query cartQuery($id:ID!$country:CountryCode$language:LanguageCode$withCarrierRates:Boolean=false)@inContext(country:$country language:$language){cart(id:$id){...@defer(if:$withCarrierRates){...CartParts}}}",Ti="query subscriptionPolicyQuery($country:CountryCode$language:LanguageCode)@inContext(country:$country language:$language){shop{subscriptionPolicy(sanitized:true){body}}}",ki="mutation cartPaymentUpdate($cartId:ID!$input:CartPaymentInput!$country:CountryCode$language:LanguageCode$withCarrierRates:Boolean=false)@inContext(country:$country language:$language){result:cartPaymentUpdate(cartId:$cartId payment:$input){...@defer(if:$withCarrierRates){cart{...CartParts}errors:userErrors{...on CartUserError{message field code}}}}}",Kt="fragment CartParts on Cart{id checkoutUrl buyerIdentity{deliveryAddressPreferences{...on MailingAddress{address1 address2 city province phone country firstName lastName zip}}}deliveryGroups(first:10 withCarrierRates:$withCarrierRates){edges{node{id groupType selectedDeliveryOption{code title description handle estimatedCost{amount currencyCode}}deliveryOptions{code title description estimatedCost{amount currencyCode}handle}}}}cost{subtotalAmount{amount currencyCode}totalAmount{amount currencyCode}totalTaxAmount{amount currencyCode}totalDutyAmount{amount currencyCode}}discountAllocations{discountedAmount{amount currencyCode}...on CartCodeDiscountAllocation{code}...on CartAutomaticDiscountAllocation{title}...on CartCustomDiscountAllocation{title}}discountCodes{code applicable}lines(first:10){edges{node{quantity cost{subtotalAmount{amount currencyCode}totalAmount{amount currencyCode}}discountAllocations{discountedAmount{amount currencyCode}...on CartCodeDiscountAllocation{code}...on CartAutomaticDiscountAllocation{title}...on CartCustomDiscountAllocation{title}}merchandise{...on ProductVariant{requiresShipping}}sellingPlanAllocation{priceAdjustments{price{amount currencyCode}}sellingPlan{billingPolicy{...on SellingPlanRecurringBillingPolicy{interval intervalCount}}priceAdjustments{orderCount}recurringDeliveries}}}}}}",Ni="mutation cartSubmitForCompletion($cartId:ID!$attemptToken:String!$country:CountryCode$language:LanguageCode)@inContext(country:$country language:$language){cartSubmitForCompletion(cartId:$cartId attemptToken:$attemptToken){result{__typename ...on SubmitSuccess{redirectUrl}...on SubmitThrottled{pollAfterV2:pollAfter}...on SubmitFailed{errors{code message}}}errors:userErrors{...on CartUserError{code field message}}}}",Li="unstable";class fe extends Error{constructor(t="No response"){super(t),this.name="NoResponseError"}}class Ke{constructor({accessToken:t,country:r,locale:n,apiVersion:a=Li,withCarrierRates:i=!1}){if(d(this,"client"),d(this,"country"),d(this,"locale"),d(this,"withCarrierRates"),d(this,"lastValidCart"),!t)throw new Error("StorefrontApiClient constructed with no access token");if(!r)throw new Error("StorefrontApiClient constructed with no buyer country");if(!n)throw new Error("StorefrontApiClient constructed with no locale");this.country=r,this.locale=n,this.withCarrierRates=i;const o="/api/".concat(a,"/graphql.json");this.client=di({headers:{"Content-Type":"application/json",Accept:"application/json","X-Shopify-Storefront-Access-Token":t,"X-SDK-Variant":"portable-wallets"},url:o,retries:0,logger:s=>{if(s.type==="HTTP-Response"){const[c,l]=s.content.requestParams;b.leaveBreadcrumb("POST: ".concat(c),{statusCode:s.content.response.status,statusText:s.content.response.statusText,url:c,method:l==null?void 0:l.method,headers:l==null?void 0:l.headers,body:l==null?void 0:l.body},"request")}}})}async createCart(t){var r;return this.requestDeferredCart(vi,{input:{lines:[{merchandiseId:t.merchandiseId,quantity:t.quantity,sellingPlanId:t.sellingPlanId,attributes:Object.entries((r=t.lineItemProperties)!=null?r:{}).map(([n,a])=>({key:n,value:a}))}],discountCodes:t.discountCodes,buyerIdentity:t.buyerIdentity}})}async updateCartBillingAddress(t){const{cartId:r,billingAddress:n}=t;return this.requestDeferredCart(Ai,{cartId:r,billingAddress:n})}async updateCartBuyerIdentity(t){const{cartId:r,emailAddress:n,streetAddress:a,countryCode:i,phone:o,preferences:s}=t;return this.requestDeferredCart(_i,{cartId:r,buyerIdentity:{email:n,countryCode:i!=null?i:a==null?void 0:a.country,phone:o!=null?o:a==null?void 0:a.phone,deliveryAddressPreferences:a?[{deliveryAddressValidationStrategy:t.validateAddress?"STRICT":"COUNTRY_CODE_ONLY",deliveryAddress:a}]:[],preferences:s}})}async updateSelectedDeliveryOptions(t,r,n){let a=r;const i=Date.now()+2e4;for(;Date.now()<i&&!(n!=null&&n.aborted);){const o=await this.requestDeferredCart(Ei,{cartId:t,selectedDeliveryOptions:a});if(!o.errors.some(c=>typeof c=="string"&&c.startsWith(p.PendingDeliveryGroups)))return o;const s=o.data.deliveryGroups.flatMap(c=>c.deliveryOptions.map(l=>({deliveryOptionHandle:l.handle,deliveryGroupId:c.id})));a=a.map(c=>{var l;return(l=s.find(u=>u.deliveryOptionHandle===c.deliveryOptionHandle))!=null?l:c})}throw new Error("Selected delivery options update operation timed out")}async applePaySessionCreate(t){var r,n,a;const i=await this.requestStream([Si],{validationUrl:t.toString()});try{for(var o=B(i),s,c,l;s=!(c=await o.next()).done;s=!1){const u=c.value;u.errors&&this.onError(u.errors);const h=(a=(n=(r=u.data)==null?void 0:r.applePaySessionCreate)==null?void 0:n.applePaySession)==null?void 0:a.body;if(h)return h}}catch(u){l=[u]}finally{try{s&&(c=o.return)&&await c.call(o)}finally{if(l)throw l[0]}}throw new fe("Apple Pay session create operation returned no response")}async paypalBuyerDetailsFetch(t,r){var n,a;const i=await this.requestStream([Pi],{token:t,cartId:r});try{for(var o=B(i),s,c,l;s=!(c=await o.next()).done;s=!1){const u=c.value;if(u.hasNext)continue;u.errors&&this.onError(u.errors);const h=(a=(n=u.data)==null?void 0:n.paypalBuyerDetailsFetch)==null?void 0:a.paypalDetails;if(h)return h}}catch(u){l=[u]}finally{try{s&&(c=o.return)&&await c.call(o)}finally{if(l)throw l[0]}}throw new fe("PayPal buyer details fetch operation returned no response")}async paypalTokenCreate(t){var r,n,a;const i=await this.requestStream([Ii],{cartId:t});try{for(var o=B(i),s,c,l;s=!(c=await o.next()).done;s=!1){const u=c.value;u.errors&&this.onError(u.errors);const h=(a=(n=(r=u.data)==null?void 0:r.paypalTokenCreate)==null?void 0:n.paypalToken)==null?void 0:a.token;if(h)return h}}catch(u){l=[u]}finally{try{s&&(c=o.return)&&await c.call(o)}finally{if(l)throw l[0]}}throw new fe("PayPal token create operation returned no response")}async fetchCart(t){var r;const n=this.formatLanguage(this.locale),a=await this.requestStream([Di,Kt],{id:t,country:this.country,language:n,withCarrierRates:this.withCarrierRates});try{for(var i=B(a),o,s,c;o=!(s=await i.next()).done;o=!1){const l=s.value;l.errors&&this.onError(l.errors);const u=(r=l.data)==null?void 0:r.cart;if(b.leaveBreadcrumb("Fetch cart response",{body:u,hasNext:l.hasNext},"log"),u&&!l.hasNext){const h=this.parseCartResponse(u);return this.lastValidCart=h,h}}}catch(l){c=[l]}finally{try{o&&(s=i.return)&&await s.call(i)}finally{if(c)throw c[0]}}throw new fe("Cart fetch operation returned no response")}async updateCartPayment(t,r,n){var a,i;const o={cartId:t,input:r},{amount:s,currencyCode:c}=r.amount;let l;const u=Date.now()+1e4;for(;Date.now()<u&&!(n!=null&&n.aborted);){const h=await this.requestDeferredCart(ki,o);if(l||(l=h),h.errors.includes(p.InvalidPaymentAmount)){parseFloat((i=(a=h.data.totalTaxAmount)==null?void 0:a.amount)!=null?i:"0")===0&&await new Promise(g=>setTimeout(g,500)),o.input.amount={amount:h.data.totalAmount.amount,currencyCode:h.data.totalAmount.currencyCode};continue}return(h.data.totalAmount.amount===s||parseFloat(h.data.totalAmount.amount)<=parseFloat(s))&&h.data.totalAmount.currencyCode===c?h:l}throw new Error("Payment update operation timed out")}async submitForCompletion(t,r){var n,a;const i=this.formatLanguage(this.locale),o=await this.request([Ni],{cartId:t,attemptToken:r,country:this.country,language:i,withCarrierRates:this.withCarrierRates});return{data:(a=(n=o.data)==null?void 0:n.cartSubmitForCompletion)==null?void 0:a.result,errors:this.parseCompletionErrors(o)}}async fetchSubscriptionPolicy(){var t,r;const{data:n}=await this.request([Ti],{country:this.country,language:this.formatLanguage(this.locale)});return(r=(t=n==null?void 0:n.shop)==null?void 0:t.subscriptionPolicy)==null?void 0:r.body}async request(t,r){return this.client.request(t.join(""),{variables:r})}async requestStream(t,r){return this.client.requestStream(t.join(""),{variables:r})}async requestDeferredCart(t,r){var n,a,i,o,s,c;const l=this.formatLanguage(this.locale),u=await this.requestStream([t,Kt],I(w({},r),{country:this.country,language:l,withCarrierRates:this.withCarrierRates}));try{for(var h=B(u),g,m,C;g=!(m=await h.next()).done;g=!1){const f=m.value;f.errors&&this.onError(f.errors);const A=(a=(n=f.data)==null?void 0:n.result)==null?void 0:a.cart;if(A&&!f.hasNext)return{data:await this.fetchCart(A.id),errors:this.parseMutationErrors(f,"result")};if(this.lastValidCart&&(o=(i=f.data)==null?void 0:i.result)!=null&&o.errors)return this.onResultError((c=(s=f.data)==null?void 0:s.result)==null?void 0:c.errors),{data:this.lastValidCart,errors:this.parseMutationErrors(f,"result")}}}catch(f){C=[f]}finally{try{g&&(m=h.return)&&await m.call(h)}finally{if(C)throw C[0]}}throw new fe("Deferred cart operation returned no response")}onError(t){var r,n;if(!t)return;b.leaveBreadcrumb("GraphQL response error",t,"error");const a=(n=(r=t.graphQLErrors)==null?void 0:r.map(s=>s.message).join(", "))!=null?n:"",i="".concat(t.message).concat(a.length>0?" - ".concat(a):""),o=t!=null&&t.networkStatusCode?"with status ".concat(t.networkStatusCode," => ").concat(i):"=> ".concat(i);throw new Error("GraphQL mutation failed ".concat(o))}onResultError(t){b.leaveBreadcrumb("GraphQL result error",t,"error")}formatLanguage(t){return t.includes("-")?t.split("-")[0].toUpperCase():t.toUpperCase()}parseCartResponse(t){var r,n,a;const i=t.lines.edges.map(s=>{var c,l;const u=s.node;return{quantity:u.quantity,totalAmount:{amount:u.cost.totalAmount.amount,currencyCode:u.cost.totalAmount.currencyCode},subtotalAmount:{amount:(c=u.cost.subtotalAmount)==null?void 0:c.amount,currencyCode:(l=u.cost.subtotalAmount)==null?void 0:l.currencyCode},merchandise:{requiresShipping:u.merchandise.requiresShipping},discountAllocations:u.discountAllocations,sellingPlanAllocation:u.sellingPlanAllocation}}),o=t.deliveryGroups.edges.map(s=>s.node);return{id:t.id,totalAmount:t.cost.totalAmount,subtotalAmount:(r=t.cost.subtotalAmount)!=null?r:void 0,totalTaxAmount:(n=t.cost.totalTaxAmount)!=null?n:void 0,totalDutyAmount:(a=t.cost.totalDutyAmount)!=null?a:void 0,discountAllocations:t.discountAllocations,discountCodes:t.discountCodes,lineItems:i,deliveryGroups:o,checkoutUrl:t.checkoutUrl}}parseGraphQlErrors(t){var r,n;return(n=(r=t==null?void 0:t.graphQLErrors)==null?void 0:r.map(a=>a.message.replace(/\(Expected.*\)/,"").trim()))!=null?n:[]}parseMutationErrors(t,r){var n,a,i;const o=this.parseGraphQlErrors(t.errors),s=((i=(a=(n=t.data)==null?void 0:n[r])==null?void 0:a.errors)==null?void 0:i.map(l=>l.code===nt?{code:nt,message:l.message}:l.field&&l.field.length>0?"".concat(l.code,": ").concat(l.field.join(".")):l.code).filter(l=>l))||[],c=[...o,...s];return b.leaveBreadcrumb("GraphQL errors on mutation",c,"error"),c}parseCompletionErrors(t){var r,n,a,i;const o=this.parseGraphQlErrors(t.errors);let s=[];((a=(n=(r=t.data)==null?void 0:r.cartSubmitForCompletion)==null?void 0:n.result)==null?void 0:a.__typename)==="SubmitFailed"&&(s=(i=t.data.cartSubmitForCompletion.result.errors.map(l=>l.code))!=null?i:[]);const c=[...o,...s];return b.leaveBreadcrumb("GraphQL errors on completion",c,"error"),c}}async function Ri({cartId:e,cartClient:t,instrumentName:r,selectedDeliveryOptions:n,abortSignal:a}){try{if(!e)throw new Error("[".concat(r,"] provided no cart ID when updating shipping method"));if(!t)throw new Error("[".concat(r,"] provided invalid cart client when updating shipping method"));return await t.updateSelectedDeliveryOptions(e,n,a)}catch(i){throw y.updateFailed(r,"updateSelectedDeliveryOptions"),i}}async function Oi({cartId:e,token:t,cartClient:r,instrumentName:n}){try{if(!e)throw new Error("[".concat(n,"] provided no cart ID when submitting for completion"));if(!r)throw new Error("[".concat(n,"] provided invalid cart client when submitting for completion"));if(!t)throw new Error("[".concat(n,"] provided no token when submitting for completion"));return await r.submitForCompletion(e,t)}catch(a){throw y.updateFailed(n,"submitForCompletion"),a}}function xi({selectedDeliveryOptionHandles:e,deliveryGroups:t,instrumentName:r}){return t.map(n=>{const a=n.deliveryOptions.filter(i=>e.includes(i.handle));if(!a.length)throw new Error("[".concat(r,"] could not find delivery option for group: ").concat(n.id));if(a.length>1)throw new Error("[".concat(r,"] found multiple delivery options with selectedDeliverOptionHandle in group: ").concat(n.id));return{deliveryGroupId:n.id,deliveryOptionHandle:a[0].handle}})}async function Fi(e){const{cartClient:t,instrumentName:r}=e;try{if(!e.cartId)throw new Error("[".concat(r,"] provided no cart ID when updating billing address"));if(!t)throw new Error("[".concat(r,"] provided invalid cart client when updating billing address"));return await t.updateCartBillingAddress(e)}catch(n){throw y.updateFailed(r,"updateBillingAddress"),n}}class $i{constructor({accessToken:t,buyerCountry:r,buyerCurrency:n,button:a,i18n:i,merchantName:o,dataSource:s,apiClient:c,walletParams:l}){d(this,"name",v.ApplePay),d(this,"accessToken"),d(this,"button"),d(this,"buyerCountry"),d(this,"cart"),d(this,"apiClient"),d(this,"dataSource"),d(this,"i18n"),d(this,"merchantName"),d(this,"session"),d(this,"paymentSheetActionGenerator"),d(this,"cancelled"),d(this,"buyerCurrency"),d(this,"customerAccountEmail"),d(this,"abortController",null),d(this,"begin",()=>{b.leaveBreadcrumb("ApplePay Session begin",{},"log"),this.abortController=typeof AbortController=="function"&&new AbortController||null,this.session.begin()}),d(this,"onvalidatemerchant",async u=>{try{const h=new URL(u.validationURL),g=this.getMerchantSession(h),{cart:m,outOfStock:C}=await ee({element:this.button,instrumentName:this.name,dataSource:this.dataSource,willHandleErrorCodes:A=>A.length===1&&A[0]===p.InvalidQuantity});this.cart=m;const f=await g;if(b.leaveBreadcrumb("ApplePay Session completeMerchantValidation",{session:f},"log"),C){this.abortAndShowOutOfStockError();return}if(this.sessionIsCancelled())return;this.session.completeMerchantValidation(f)}catch(h){y.sheetClicked({instrument:v.ApplePay,result:"failed"}),this.terminateSession(h)}}),d(this,"onshippingcontactselected",async u=>{try{const h=Ie(u.shippingContact),g=await ke({cartId:this.cart.id,streetAddress:h,cartClient:this.apiClient,instrumentName:this.name});if(this.decelerateIfCurrencyChanged(g.data))return;await this.applyPaymentSheetActions(g,m=>this.completeShippingContactSelection(g.data,m),{shippingRequired:this.isShippingRequired})}catch(h){this.terminateSession(h)}}),d(this,"onshippingmethodselected",async u=>{var h;try{const g=u.shippingMethod.identifier.split(","),m=xi({selectedDeliveryOptionHandles:g,deliveryGroups:this.cart.deliveryGroups,instrumentName:this.name}),C=await Ri({cartId:this.cart.id,cartClient:this.apiClient,instrumentName:this.name,selectedDeliveryOptions:m,abortSignal:(h=this.abortController)==null?void 0:h.signal});await this.applyPaymentSheetActions(C,()=>this.completeShippingMethodSelection(C.data))}catch(g){this.terminateSession(g)}}),d(this,"onpaymentmethodselected",async u=>{try{const{billingContact:h}=u.paymentMethod;if(!this.isShippingRequired&&h){const C=Ie(h),f=await ke({cartId:this.cart.id,countryCode:C.country,cartClient:this.apiClient,instrumentName:this.name});if(this.decelerateIfCurrencyChanged(f.data))return;await this.applyPaymentSheetActions(f,()=>this.cart=f.data);const A=await Fi({billingAddress:C,cartId:this.cart.id,cartClient:this.apiClient,instrumentName:this.name});await this.applyPaymentSheetActions(A,()=>this.cart=A.data)}const{newTotal:g,newLineItems:m}=this.getNewTotalAndLineItems(this.cart);if(b.leaveBreadcrumb("ApplePay Session completePaymentMethodSelection",{newTotal:g,newLineItems:m},"log"),this.sessionIsCancelled())return;this.session.completePaymentMethodSelection({newTotal:g,newLineItems:m})}catch(h){this.terminateSession(h)}}),d(this,"oncancel",()=>{var u;this.cancelled=!0,y.sheetCancelled(this.name),this.button.disabled=!1,(u=this.abortController)==null||u.abort()}),d(this,"onpaymentauthorized",async u=>{y.authorizationAttempt(this.name),je(L.AuthorizationLatency,this.name);const h=D=>{y.authorizationComplete({instrument:this.name,measurement:X(L.AuthorizationLatency,this.name),result:"failure"}),this.terminateSession(D)},g=async D=>{var ue,No;switch((ue=D.effects)==null||ue.forEach(Wn=>Wn()),D.action){case"complete":{const Wn=ApplePaySession.STATUS_SUCCESS;try{await this.completePayment(Wn),Z(D.redirectUrl)}catch(ko){h(ko)}break}case"show_error":{const Wn=(No=D.errors)!=null?No:[];try{await this.completePayment(ApplePaySession.STATUS_FAILURE,Wn)}catch(ko){h(ko)}break}case"abort":{try{await this.completePayment(ApplePaySession.STATUS_FAILURE),this.button.disabled=!1}catch(Wn){h(Wn)}break}default:h(new Error("[".concat(this.name,"] completion action not handled: ").concat(D.action)))}},{token:m,billingContact:C,shippingContact:f}=u.payment;let A=null,kt=null;try{if(!C){await this.completePayment(ApplePaySession.STATUS_FAILURE);return}if(A=Ie(I(w({},C),{phoneNumber:f==null?void 0:f.phoneNumber})),this.isShippingRequired){if(!f){await this.completePayment(ApplePaySession.STATUS_FAILURE);return}kt=Ie(f)}}catch(D){h(D);return}const Do=async()=>{var D;try{const ue=this.isShippingRequired?{validateAddress:!0,streetAddress:kt}:{},No=(D=this.customerAccountEmail)!=null?D:f==null?void 0:f.emailAddress,Wn=await ke(w({cartId:this.cart.id,emailAddress:No,cartClient:this.apiClient,instrumentName:this.name},ue)),ko=this.paymentSheetActionGenerator.mapMutationResultToPaymentSheetAction(Wn);await Qe({paymentSheetAction:ko,onProceed:async Fo=>{Fo&&Fo.length>0?await this.completePayment(ApplePaySession.STATUS_FAILURE,Fo):await Oo()},terminateSession:h})}catch(ue){h(ue)}},Oo=async()=>{var D;try{const ue=this.cart.lineItems.some(ko=>!!ko.sellingPlanAllocation),No=await yn({cartId:this.cart.id,totalAmount:this.cart.totalAmount,paymentMethod:{walletPaymentMethod:{applePayWalletContent:{billingAddress:A,data:m.paymentData.data,header:m.paymentData.header,lastDigits:m.paymentMethod.displayName.split(" ")[1],signature:m.paymentData.signature,version:m.paymentData.version}}},canUsePaymentMethodForFreeOrder:!1,billingAddress:A,cartClient:this.apiClient,instrumentName:this.name,hasSellingPlan:ue,abortSignal:(D=this.abortController)==null?void 0:D.signal}),Wn=this.paymentSheetActionGenerator.mapMutationResultToPaymentSheetAction(No);await Qe({paymentSheetAction:Wn,onProceed:async ko=>{ko&&ko.length>0?await this.completePayment(ApplePaySession.STATUS_FAILURE,ko):await Ho()},terminateSession:h})}catch(ue){h(ue)}},Ho=async()=>{try{const D=await Oi({cartId:this.cart.id,token:m.transactionIdentifier,cartClient:this.apiClient,instrumentName:this.name}),ue=this.paymentSheetActionGenerator.mapCompletionResultToPaymentSheetAction(D);await g(ue)}catch(D){h(D)}};await Do()}),d(this,"terminateSession",u=>{var h;this.button.disabled=!1,u&&b.notify(u),y.sheetFailed(this.name,u);try{b.leaveBreadcrumb("ApplePay Session abort",{},"log"),this.session.abort(),(h=this.abortController)==null||h.abort()}catch(g){b.notify(g)}if(u){const g=this.i18n.translate("brand.apple_pay");q(this.i18n.translate("error_dialogs.wallet.title",{wallet:g}),this.i18n.translate("error_dialogs.wallet.generic_error",{wallet:g}))}}),d(this,"abortAndShowOutOfStockError",()=>{var u;this.session.abort(),(u=this.abortController)==null||u.abort(),Se(this.i18n)}),d(this,"getMostRecentNonNullCart",(u,h)=>u?(this.cart=u,u):h),d(this,"handleNullCart",u=>{if(!u)throw new Error("[".concat(this.name,"] no cart returned on mutation, aborting"))}),d(this,"completeShippingContactSelection",(u,h)=>{try{const g=this.getMostRecentNonNullCart(u,this.cart),{newTotal:m,newLineItems:C}=this.getNewTotalAndLineItems(g),f=Ga(g.deliveryGroups,this.i18n);b.leaveBreadcrumb("ApplePay Session completeShippingContactSelection",{errors:h,newTotal:m,newLineItems:C,newShippingMethods:f},"log"),this.session.completeShippingContactSelection({errors:h!=null?h:[],newTotal:m,newLineItems:C,newShippingMethods:f})}catch(g){this.terminateSession(g)}}),d(this,"completeShippingMethodSelection",u=>{try{this.handleNullCart(u),this.cart=u;const{newTotal:h,newLineItems:g}=this.getNewTotalAndLineItems(u);b.leaveBreadcrumb("ApplePay Session completeShippingContactSelection",{newTotal:h,newLineItems:g},"log"),this.session.completeShippingMethodSelection({newTotal:h,newLineItems:g})}catch(h){this.terminateSession(h)}}),d(this,"sessionIsCancelled",()=>this.cancelled),this.accessToken=t,this.buyerCountry=r,this.button=a,this.cart=null,this.apiClient=c,this.dataSource=s,this.i18n=i,this.merchantName=o,this.cancelled=!1,this.buyerCurrency=n,this.customerAccountEmail=l.customerAccountEmail,this.session=new ApplePaySession(Zt,Za({shippingRequired:this.isShippingRequired,walletParams:l,buyerCurrency:n})),this.session.onvalidatemerchant=this.onvalidatemerchant,this.session.onshippingcontactselected=this.onshippingcontactselected,this.session.onshippingmethodselected=this.onshippingmethodselected,this.session.onpaymentmethodselected=this.onpaymentmethodselected,this.session.oncancel=this.oncancel,this.session.onpaymentauthorized=this.onpaymentauthorized,this.paymentSheetActionGenerator=new Xa(i)}async applyPaymentSheetActions(t,r,n){var a;const i=this.paymentSheetActionGenerator.mapMutationResultToPaymentSheetAction(t,n);(a=i.effects)==null||a.forEach(o=>o()),!this.sessionIsCancelled()&&await Qe({paymentSheetAction:i,onProceed:r,terminateSession:this.terminateSession})}async getMerchantSession(t){const r=await new Ke({accessToken:this.accessToken,country:this.buyerCountry,locale:this.i18n.locale,apiVersion:"unstable"}).applePaySessionCreate(t);return JSON.parse(r)}async completePayment(t,r=void 0){b.leaveBreadcrumb("ApplePay Session completePayment",{status:t,errors:r},"log"),this.session.completePayment({status:t,errors:r}),y.authorizationComplete({instrument:this.name,measurement:X(L.AuthorizationLatency,this.name),result:t===ApplePaySession.STATUS_SUCCESS?"success":"failure"})}getNewTotalAndLineItems(t){return{newTotal:Ua(this.merchantName,t.totalAmount),newLineItems:za({subtotal:ei(t),discountAllocations:ti(t),deliveryGroups:t.deliveryGroups,duties:t.totalDutyAmount,taxes:t.totalTaxAmount,i18n:this.i18n,formattedRecurringTotals:ni(this.cart.lineItems,this.i18n)})}}decelerateIfCurrencyChanged(t){const r=t!=null?t:this.cart;return gn({cart:r,buyerCurrency:this.buyerCurrency,instrumentName:this.name})?(this.terminateSession(),!0):!1}get isShippingRequired(){return this.button.isShippingRequired}}const Mi='<svg viewBox="0 0 43 19" xmlns="http://www.w3.org/2000/svg" width="45px" style="width: 45px;">\n  <path d="M6.948 1.409C7.934.147 9.305.147 9.305.147s.193 1.18-.771 2.316c-1.05 1.2-2.228.993-2.228.993s-.236-.93.642-2.047zM3.82 3.663c-1.735 0-3.6 1.51-3.6 4.363 0 2.916 2.186 6.555 3.943 6.555.6 0 1.543-.6 2.485-.6.922 0 1.607.559 2.464.559 1.907 0 3.322-3.826 3.322-3.826s-2.015-.744-2.015-2.936c0-1.944 1.629-2.73 1.629-2.73s-.836-1.447-2.936-1.447c-1.22 0-2.164.661-2.656.661-.622.021-1.5-.6-2.636-.6zM19.64 1.426c2.453 0 4.188 1.788 4.188 4.396 0 2.608-1.755 4.417-4.248 4.417h-2.932v4.564h-1.974V1.426h4.966zm-2.992 7.067h2.473c1.695 0 2.693-.967 2.693-2.65 0-1.683-.978-2.671-2.693-2.671h-2.473v5.321zm7.559 3.429c0-1.767 1.296-2.777 3.65-2.945l2.572-.147v-.78c0-1.156-.738-1.787-1.994-1.787-1.037 0-1.795.568-1.955 1.43h-1.775c.06-1.788 1.656-3.092 3.79-3.092 2.333 0 3.829 1.304 3.829 3.281v6.9h-1.815v-1.684h-.04c-.519 1.094-1.715 1.788-3.012 1.788-1.934.021-3.25-1.178-3.25-2.965zm6.222-.905v-.778l-2.313.168c-1.297.084-1.975.59-1.975 1.494 0 .862.718 1.409 1.815 1.409 1.396-.021 2.473-.968 2.473-2.293zm3.969 7.383v-1.64c.14.041.438.041.598.041.897 0 1.416-.4 1.735-1.472l.14-.526L33.4 4.707h2.054l2.453 8.224h.04L40.4 4.707h1.994l-3.57 10.538c-.818 2.419-1.715 3.197-3.67 3.197-.14.02-.598-.021-.757-.042z"/>\n</svg>\n';function Rn({buttonContent:e,logoElement:t,setAriaHidden:r}){const n=document.createElement("div");return e.split(new RegExp("(".concat(tt,")"))).filter(Boolean).forEach(a=>{let i;a===tt?i=t:(i=document.createElement("span"),i.innerText=a,r&&i.setAttribute("aria-hidden","true")),n.appendChild(i)}),n}class Bi extends te{constructor(){super(),d(this,"name",v.ApplePay),d(this,"fragment",null),d(this,"button",null),d(this,"logoElement"),this.logoElement=new DOMParser().parseFromString(Mi,"image/svg+xml").documentElement}static get observedAttributes(){return["disabled"]}get merchantName(){return this.walletParams.merchantName}connectedCallback(){this.cleanupOnFailure(this.render.bind(this),this.name)}attributeChangedCallback(t,r,n){super.attributeChangedCallback(t,r,n,this.button)}async handleClick(t){if(t.preventDefault(),this.disabled||!this.button||this.button.hasAttribute("aria-disabled"))return;this.disabled=!0;const[r,n,a]=await Promise.all([this.i18n,this.dataSource,this.apiClient]);let i;try{if(i=new $i({accessToken:this.accessToken,buyerCountry:this.buyerCountry,buyerCurrency:this.buyerCurrency,button:this,i18n:r,merchantName:this.merchantName,dataSource:n,apiClient:a,walletParams:this.walletParams}),!i)throw new Error("missing ApplePaySession");i.begin(),y.sheetClicked({instrument:this.name,result:"success"})}catch(o){b.notify(o),y.sheetClicked({instrument:this.name,result:"failed"}),i==null||i.terminateSession()}}async render(){var t;if(!this.button){const r=await this.classNames;this.button=ze(),this.button.onclick=a=>this.handleClick(a),this.button.className="apple-pay-button ".concat(lr[this.buttonTheme]," ").concat(r);const n=this.hasAttribute("call-to-action");await this.addBranding(this.button,n)}if(this.disabled&&this.button.setAttribute("aria-disabled","true"),!this.fragment){this.fragment=document.createDocumentFragment();const r=document.createElement("style");r.innerHTML=Ma,this.fragment.append(r,this.button),this.appendChild(this.fragment),(t=this.onRendered)==null||t.call(this)}}async addBranding(t,r){const n=await this.i18n,a=n.translate("buy_with_button_content"),i=n.translate("brand.apple_pay");t.setAttribute("aria-label",r?a.replace(tt,i):i),t.appendChild(this.htmlContent(r?a:null))}htmlContent(t){if(!t)return this.logoElement;const r=Rn({buttonContent:t,logoElement:this.logoElement,setAriaHidden:!0});return r.classList.add("apple-pay--content"),r}}function Pt(e){return function(t,r,n){const a=n.value;return n.value=function(...i){const o=a.apply(this,i);return o.eligible||console.debug("[DEBUG] ".concat(e," could not be rendered. Reason: ").concat(o.reason)),o},n}}var Ui=Object.defineProperty,zi=Object.getOwnPropertyDescriptor,On=(e,t,r,n)=>{for(var a=zi(t,r),i=e.length-1,o;i>=0;i--)(o=e[i])&&(a=o(t,r,a)||a);return a&&Ui(t,r,a),a};class It extends G{constructor(t){super(t),d(this,"companyFieldRequired"),this.companyFieldRequired=!!this.walletParams.companyRequired}static walletName(){return"apple_pay"}getWebComponentName(){return"shopify-apple-pay-button"}getWebComponentClass(){return Bi}getInstrumentName(){return v.ApplePay}applePayInIframe(){return typeof window>"u"||window.self!==window.top}getLoadEligibility(){return this.applePayInIframe()?{eligible:!1,reason:"cannot be loaded in an iframe"}:{eligible:!0}}getPartnerSDKEligibility(){var t,r,n,a;return typeof window>"u"||window.ApplePaySession===void 0?{eligible:!1,reason:"window or ApplePaySession is undefined"}:(r=(t=window.ApplePaySession).supportsVersion)!=null&&r.call(t,Zt)?(a=(n=window.ApplePaySession).canMakePayments)!=null&&a.call(n)?{eligible:!0}:{eligible:!1,reason:"failed SDK eligibility check"}:{eligible:!1,reason:"SDK does not meet minimum version requirement"}}}On([Pt("Apple Pay")],It.prototype,"getLoadEligibility"),On([Pt("Apple Pay")],It.prototype,"getPartnerSDKEligibility");const Hi=".buy-with-prime-button:hover:enabled{background-color:#0684eb!important}.buy-with-prime-button:focus{box-shadow:0 0 0 2px #1a98ff,inset 0 0 0 2px rgb(var(--color-background))!important;outline:none!important}.buy-with-prime-button:active,.buy-with-prime-button:hover:enabled:active{background-color:#0066cd!important;box-shadow:none!important}";class Ne extends Error{constructor(){super(...arguments),d(this,"name","MissingAccessTokenError")}}class Dt extends Error{constructor(){super(...arguments),d(this,"name","FetchingWalletsPlatformConfigError")}}class xn extends Error{constructor(){super(...arguments),d(this,"name","EmptyLineItemsWalletsPlatformConfigError")}}async function Fn({configOptionsEndpoint:e,checkoutUrl:t,sourceId:r,accessToken:n,instrument:a}){try{const i=JSON.stringify({checkout_url:t,checkout_cancel_url:window.location.href,cart_id:r}),o=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json","X-Shopify-Storefront-Access-Token":n},body:i});if(o.ok)return o.json();const s=await o.json();throw s.error?new Error(s.error):new Error("Could not fetch wallets platform configs: [".concat(o.status,"] ").concat(o.statusText))}catch(i){const{message:o}=i!=null?i:{};switch(o){case"empty_line_items":throw new xn("[Fetch Pay Config][".concat(a,"] No eligible line items provided in the config request."));default:throw new Dt("[Fetch Pay Config][".concat(a,"] ").concat(o))}}}const qi={[_.Checkout]:"Checkout",[_.CartAjax]:"Cart",[_.CartPage]:"Cart",[_.ProductPage]:"Product",[_.Unknown]:"Product"},oe=class Mo extends te{constructor(){super(...arguments),d(this,"name",v.BuyWithPrime),d(this,"fragment",null),d(this,"button",null)}connectedCallback(){this.cleanupOnFailure(this.render.bind(this),this.name)}disconnectedCallback(){}async createButton(){const t=ze();t.type="button",t.className="buy-with-prime-button";const r=await this.i18n;return t.setAttribute("aria-label",r.translate("brand.buy_with_prime")),Q(t,{width:"100%","padding-top":"12px","padding-bottom":"8px","padding-right":"10px","padding-left":"10px",display:"flex","align-items":"center","justify-content":"center",gap:"5px",opacity:"1","border-width":"0px"}),this.applyEnabledStyles(t),t}applyEnabledStyles(t){t.innerHTML=Ae.primeLogo,t.disabled=!1,Q(t,{"background-color":"#1A98FF",color:"#FFFFFF",cursor:"pointer"})}applyDisabledStyles(t){t.innerHTML=Ae.primeLogoDark,t.disabled=!0,Q(t,{"background-color":"#C0E3FF",color:"#7292AC",cursor:"not-allowed"})}async handleClick(){var t;if(!this.button)return;const[r,n]=await Promise.all([this.i18n,this.dataSource]);let a,i;try{this.applyDisabledStyles(this.button);let o=this.walletParams;if(a=o.appId,!o.createCheckoutSessionConfig){if(i=(await ee({element:this,instrumentName:this.name,dataSource:n})).cart,!this.accessToken)throw new Ne("[Fetch Pay Config] could not fetch pay configs since required accessToken is missing.");o=w({},await Fn({configOptionsEndpoint:Mo.OPTIMUS_CONFIG_REST_API_URL,checkoutUrl:i.checkoutUrl,sourceId:(t=Ue(i))!=null?t:"",accessToken:this.accessToken,instrument:this.name}))}o.placement=this.pageType&&qi[this.pageType]||"Other",delete o.checkoutSupportsSplitCart,delete o.appId,window.amazon.buywithprime.initCheckout({amazonPayOptions:o}),y.sheetClicked({instrument:this.name,result:"success",webPixelMetaData:a?{apiClientId:a,cart:i,pageType:this.pageType}:void 0})}catch(o){const{name:s}=o!=null?o:{};Mo.EXPECTED_ERRORS.includes(s)||b.notify(o),y.sheetClicked({instrument:this.name,result:"failed",webPixelMetaData:a?{apiClientId:a,cart:i,pageType:this.pageType}:void 0});const{title:c,content:l}=this.getErrorCopies(s,r);q(c,l)}finally{this.applyEnabledStyles(this.button)}}getErrorCopies(t,r){const n=r.translate("brand.buy_with_prime");switch(t){case"EmptyLineItemsWalletsPlatformConfigError":return{title:r.translate("error_dialogs.wallet.buy_with_prime.empty_line_items.title"),content:r.translate("error_dialogs.wallet.buy_with_prime.empty_line_items.content")};default:return{title:r.translate("error_dialogs.wallet.title",{wallet:n}),content:r.translate("error_dialogs.wallet.generic_error",{wallet:n})}}}async render(){var t;if(!this.button){const r=await this.classNames;this.button=await this.createButton(),this.button.onclick=()=>this.handleClick(),this.button.className="buy-with-prime-button ".concat(r)}if(!this.fragment){this.fragment=document.createDocumentFragment();const r=document.createElement("style");r.innerHTML=Hi,this.fragment.append(r,this.button),this.appendChild(this.fragment)}(t=this.onRendered)==null||t.call(this)}};d(oe,"OPTIMUS_CONFIG_REST_API_URL","".concat(window.location.origin,"/wallets/config/optimus")),d(oe,"EXPECTED_ERRORS",[Dt.name,Ne.name,xn.name]);let ut=oe;function $n(e,t=3,r=1e3,n=()=>!0){const a=()=>new Promise(o=>{setTimeout(o,r)}),i=async o=>{try{return await e()}catch(s){if(o>0&&n(s))return await a(),i(o-1);throw s}};return i(t-1)}async function Je(e){const t=e.createCheckoutSessionConfig,r=JSON.parse(t.payloadJSON),n=new URL(r.webCheckoutDetails.checkoutReviewReturnUrl),a=await(await fetch("https:///sandbox/v2/checkoutSessions",{method:"POST",body:JSON.stringify(e),headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"}})).json();n.searchParams.set("amazonCheckoutSessionId",a.checkoutSessionId||"testCheckoutSessionId"),n.searchParams.set("promiseId","testPromiseId"),Z(n.toString())}const Mn={buywithprime:{initCheckout:async e=>{Je(e.amazonPayOptions)}},Pay:{initCheckout:async e=>{Je(e)},renderButton:()=>({initCheckout:Je,onClick:()=>{}})}};async function ji(){return window.amazon=Mn,"loaded"}async function Wi(e){return new Promise((t,r)=>{if(document.querySelector('script[src="'.concat(e,'"]'))&&window.amazon){t();return}const n=document.createElement("script");n.src=e,n.onload=()=>{window.amazon?t():r(new Error("Amazon SDK not present after loading"))},n.onerror=()=>{r(new Error("Error loading Amazon SDK"))},document.head.append(n)})}async function Bn({sdkUrl:e=bt,maxRetries:t=3,shouldMock:r=!1}){if(r){await ji();return}await $n(()=>Wi(e),t,0)}const $=class To extends G{static walletName(){return"buy_with_prime"}constructor(t){super(t)}getWebComponentName(){return"shopify-buy-with-prime-button"}getInstrumentName(){return v.BuyWithPrime}isMockedAmazonServiceUsed(){return!1}getWebComponentClass(){return ut}async loadWalletSDK(){await Bn({sdkUrl:To.SDK_URL,shouldMock:this.isMockedAmazonServiceUsed(),maxRetries:To.MAX_RETRIES}),await this.loadLogos()}async loadLogos(){await Promise.all([this.loadPrimeLogo(),this.loadPrimeLogoDark()])}async loadPrimeLogo(){To.primeLogo=(await import("./prime-logo-DoVHKBSO.js")).default}async loadPrimeLogoDark(){To.primeLogoDark=(await import("./prime-logo-dark-DJIA6J0w.js")).default}};d($,"MAX_RETRIES",3),d($,"SDK_URL",bt),d($,"primeLogo"),d($,"primeLogoDark");let Ae=$;const z=class xo extends te{constructor(){super(...arguments),d(this,"name",v.AmazonPay),d(this,"container",null)}connectedCallback(){this.cleanupOnFailure(this.render.bind(this),this.name)}async handleClick(t){var r;const[n,a]=await Promise.all([this.i18n,this.dataSource]);try{const{cart:i}=await ee({element:this,instrumentName:this.name,dataSource:a}),{totalAmount:{amount:o},checkoutUrl:s}=i;let c=this.walletParams;if(!c.createCheckoutSessionConfig){if(!this.accessToken)throw new Ne("[Fetch Pay Config] could not fetch pay configs since required accessToken is missing.");c=I(w({},await Fn({configOptionsEndpoint:xo.CV2_CONFIG_REST_API_URL,checkoutUrl:s,sourceId:(r=Ue(i))!=null?r:"",accessToken:this.accessToken,instrument:this.name})),{placement:this.pageType===_.ProductPage?"Product":"Cart"})}delete c.appId,t.initCheckout(w(w({},c),Number(o)!==0&&{estimatedOrderAmount:{amount:o,currencyCode:this.buyerCurrency}})),y.sheetClicked({instrument:this.name,result:"success"})}catch(i){const{name:o}=i!=null?i:{};xo.EXPECTED_ERRORS.includes(o)||b.notify(i),y.sheetClicked({instrument:this.name,result:"failed"});const s=n.translate("brand.amazon_pay");q(n.translate("error_dialogs.wallet.title",{wallet:s}),n.translate("error_dialogs.wallet.generic_error",{wallet:s}))}}async createContainer(){const t=await this.classNames,r=document.createElement("div");return r.id=xo.CONTAINER_ID,r.style.display="flex",r.className=t,r}async render(){var t;try{if(!this.container){this.container=await this.createContainer(),this.appendChild(this.container);const r=window.amazon.Pay.renderButton("#".concat(xo.CONTAINER_ID),I(w({},this.walletParams),{placement:this.pageType===_.ProductPage?"Product":"Cart"}));r==null||r.onClick(()=>this.handleClick(r)),(t=this.onRendered)==null||t.call(this)}}catch(r){b.notify(r)}}};d(z,"CV2_CONFIG_REST_API_URL","".concat(window.location.origin,"/wallets/config/amazon_pay")),d(z,"CONTAINER_ID","PortableWalletsAmazonPayButtonContainer"),d(z,"EXPECTED_ERRORS",[Dt.name,Ne.name]);let ht=z;const se=class Bo extends G{static walletName(){return"amazon_pay"}constructor(t){super(t)}getWebComponentName(){return"shopify-amazon-pay-button"}getInstrumentName(){return v.AmazonPay}isMockedAmazonServiceUsed(){return!1}getWebComponentClass(){return ht}async loadWalletSDK(){if(await Bn({sdkUrl:Bo.SDK_URL,shouldMock:!1,maxRetries:Bo.MAX_RETRIES}),this.isMockedAmazonServiceUsed()){const t=window.amazon.Pay.renderButton;window.amazon.Pay.renderButton=(r,n)=>{const a=t(r,n);return a.initCheckout=Mn.Pay.initCheckout,a}}}};d(se,"MAX_RETRIES",3),d(se,"SDK_URL",bt);let pt=se;var Xe={Purple:{D0:"#4524DB",D1:"#30368D",D2:"#1C234C",L0:"#6445ED",L1:"#9C83F8",L2:"#EEEAFF",L3:"#F7F5FF",Primary:"#5433EB",PrimaryLight:"#DBD1FF"},Grayscale:{Black:"#000000",D0:"#666666",D1:"#404040",D2:"#121212",D3:"#0B0B0C",D2D:"#2A2A2A",PrimaryLight:"#707070",L1:"#A8A8A7",L2:"#CBCBCA",L2L:"#E3E3E3",L3:"#F0F0F0",L4:"#F2F4F5",White:"#FFFFFF"},Green:{D1:"#008552",D2:"#004839",L1:"#BAEBCB",L2:"#D2F2DE",L3:"#E4F6EB",Primary:"#92D08D"},Poppy:{D0:"#F05D38",D1:"#D92A0F",D2:"#832711",L1:"#FFD2C2",L2:"#FFECE9",Primary:"#FF967D"},Ochre:{D0:"#F8DB67",D1:"#E3BE2B",D2:"#C29D05",D4:"#443600",L1:"#FFF4CB",L2:"#FFF9E2",Primary:"#FFEC9F"},Brand:{Aqua:"#8DC0C6",Lime:"#C7DE00",Magenta:"#D354FF",Olive:"#8B8F01",Sage:"#D8E59D",Sand:"#F4F4ED",Violet:"#A327C2"}},Ki={none:0,xs:4,xs100:6,s:8,s100:10,m:12,l:16,xl:20,xxl:28,max:999999},Vi={0:0,none:0,xxxs:2,xxs:4,xs:8,"xs-s":12,s:16,gutter:20,m:24,l:32,section:36,xl:40,xxl:48,xxxl:64,auto:"auto"},Gi=class extends HTMLElement{static get observedAttributes(){return["disabled"]}constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this._updateButton()}attributeChangedCallback(){this._updateButton()}_updateButton(){var e;let t=this.shadowRoot;t&&(t.innerHTML=Qi,this.hasAttribute("disabled")&&((e=this.shadowRoot.querySelector("button"))==null||e.setAttribute("disabled","")))}};function Yi(){window.customElements&&(customElements.get("gravity-button")||customElements.define("gravity-button",Gi))}var Qi="\n<style>\n  * {\n    box-sizing: border-box;\n    border-width: 0;\n    border-style: solid;\n    border-color: currentColor;\n    --focused-box-shadow: 0 0 0 3px #DBD1FF, 0 0 #0000;\n  }\n\n  button {\n    text-transform: none;\n    -webkit-appearance: button;\n    background-color: transparent;\n    background-image: none;\n    font-family: inherit;\n    font-feature-settings: inherit;\n    font-variation-settings: inherit;\n    font-size: 100%;\n    font-weight: inherit;\n    line-height: inherit;\n    letter-spacing: inherit;\n    color: inherit;\n    margin: 0;\n    padding: 0;\n    cursor: pointer;\n  }\n\n  button:disabled {\n    cursor: default;\n    opacity: 0.5;\n  }\n\n  .gravity-button {\n    position: relative;\n    display: flex;\n    height: var(--gravity-button-height);\n    width: var(--gravity-button-width, 260px);\n    justify-content: center;\n    color: ".concat(Xe.Grayscale.White,";\n    align-items: center;\n    overflow: visible;\n    padding: var(--gravity-button-padding, ").concat(Vi.s,"px 10px);\n    border-radius: var(--buttons-radius-outset, var(--gravity-button-border-radius, ").concat(Ki.m,"px));\n    border: none;\n    background-color: ").concat(Xe.Purple.Primary,";\n    transition: all;\n  }\n\n  .gravity-button:not([disabled]):focus-visible {\n    box-shadow: var(--focused-base-box-shadow, var(--focused-box-shadow));\n    outline: var(--focused-base-outline, 2px solid transparent);\n    outline-offset: var(--focused-base-outline-offset, 2px);\n  }\n\n  .gravity-button:not([disabled]):hover {\n    background-color: ").concat(Xe.Purple.D0,';\n  }\n</style>\n\n<button class="gravity-button">\n  <slot id="button-content"></slot>\n</button>\n');const Ji=".gravity-button-wrapper{--gravity-button-width: 100%;--gravity-button-height: 100%;--gravity-button-border-radius: var(--wallet-button-border-radius);display:flex}.button-content{display:flex;align-items:center;justify-content:center;width:100%;height:100%;gap:3px;white-space:nowrap;container-type:inline-size;container-name:bc}.ShopPromise>.separator{margin:0 8px}@container bc (width <= 338px){.ShopPromise{display:none!important}}";class Un extends Error{constructor(){const t="DeliveryEstimatesResponseIsNullError";super("deliveryEstimates is null or undefined"),this.name=t}}class Ze extends Error{constructor(){const t="DeliveryPromiseAPIClientError";super("window.Shopify.ShopPromise.deliveryPromiseAPIClient is undefined"),this.name=t}}const Xi=15,Zi=200;class eo{constructor(t){d(this,"storefrontAPIToken"),this.storefrontAPIToken=t}async fetchDeliveryPromise({variant:t,postalCode:r,defaultPostalCode:n,sellingPlanId:a}){const i=await $n(async()=>this.fetchDeliveryOptions(t,r,n,a),Xi,Zi,o=>o instanceof Ze).catch(o=>{if(o instanceof Ze)throw o;return null});if(!i)throw new Un;return i}async fetchDeliveryOptions(t,r,n,a){var i,o;const s={variantId:t,sellingPlanId:a,postalCode:r||n,isPostalCodeOverride:!!r},c=(o=(i=window==null?void 0:window.Shopify)==null?void 0:i.ShopPromise)==null?void 0:o.deliveryPromiseAPIClient;if(!c)throw new Ze;return c(s,this.storefrontAPIToken)}}function to(e,t){switch(e){case 0:return(t==null?void 0:t.translate("shop_promise_delivery.same_day"))||null;case 1:return(t==null?void 0:t.translate("shop_promise_delivery.next_day"))||null;case 2:return(t==null?void 0:t.translate("shop_promise_delivery.two_day"))||null;default:return(t==null?void 0:t.translate("shop_promise_delivery.two_day"))||null}}const no="delivery_promise_default_address",ro="delivery_promise_postal_code";class ao extends He{constructor(){super(...arguments),d(this,"lastFetchedProductVariantId"),d(this,"lastFetchSellingPlan"),d(this,"fetching",!1),d(this,"i18n",null),d(this,"daysToDelivery"),d(this,"formObserver",null)}async connectedCallback(){this.formObserver=new mn(this,({variantId:t,sellingPlanId:r})=>{this.fetchDeliveryPromise(t,r)}),this.formObserver.setupMutationObservers()}setTranslations(t){this.i18n=t,this.render()}get postalCode(){try{return JSON.parse(W(ro)||"null")||null}catch(t){return null}}get defaultDeliveryAddress(){try{return JSON.parse(W(no)||"null")}catch(t){return null}}async fetchDeliveryPromise(t,r){var n,a;if(!(!t||!this.accessToken)&&!(t===this.lastFetchedProductVariantId&&r===this.lastFetchSellingPlan))try{this.lastFetchedProductVariantId=t,this.lastFetchSellingPlan=r;const i=((n=this.defaultDeliveryAddress)==null?void 0:n.zip)||"",o=await new eo(this.accessToken).fetchDeliveryPromise({variant:t,postalCode:this.postalCode||"",defaultPostalCode:i,sellingPlanId:r||""}),s=Et(this);if((s==null?void 0:s.sellingPlanId)!==r||(s==null?void 0:s.variantId)!==t)return;this.daysToDelivery=(a=o==null?void 0:o.selectedShippingOption)==null?void 0:a.maxCalendarDaysToDelivery,this.render()}catch(i){i instanceof Un&&(this.daysToDelivery=null)}}render(){const t=to(this.daysToDelivery,this.i18n);this.classList.add("ShopPromise"),this.innerHTML=t?'<span class="separator">|</span><span>'.concat(t,"</span>"):""}}class io extends te{constructor(){super(...arguments),d(this,"name",v.ShopPay),d(this,"fragment",null),d(this,"button",null),d(this,"shopPromiseProductPageContent",null),d(this,"shopPromiseEligible",!1)}static get observedAttributes(){return["disabled"]}connectedCallback(){this.shopPromiseEligible=ln(),this.cleanupOnFailure(async()=>{Yi(),await this.render()},this.name)}attributeChangedCallback(t,r,n){super.attributeChangedCallback(t,r,n,this.button)}createAndAppendStyleFragment(){if(!this.button)return;this.fragment=document.createDocumentFragment();const t=document.createElement("style");t.innerHTML=Ji,this.fragment.append(t,this.button),this.appendChild(this.fragment)}async addButtonContent(){if(!this.button)return;const t=await this.i18n,r=this.hasAttribute("call-to-action"),n=t.translate("buy_with_button_content");let a;const i=new DOMParser().parseFromString(Hn.shopPayLogoElement,"image/svg+xml").documentElement;r?a=Rn({buttonContent:n,logoElement:i,setAriaHidden:!1}):(a=document.createElement("div"),a.appendChild(i)),a.classList.add("button-content"),this.shopPromiseEligible&&!this.shopPromiseProductPageContent&&(this.shopPromiseProductPageContent=document.createElement("shop-promise-product-page-content"),this.shopPromiseProductPageContent.setTranslations(t),this.shopPromiseProductPageContent.setAttribute("access-token",this.accessToken||""),a.appendChild(this.shopPromiseProductPageContent)),this.button.appendChild(a)}getShopPayBehavior(){return this.pageType===_.ProductPage?"force_shop_pay_product":this.pageType===_.CartPage?"force_shop_pay_cart":"force_shop_pay"}async handleClick(t){if(t.preventDefault(),this.disabled||!this.button||this.button.getAttribute("disabled"))return;this.disabled=!0;const[r,n]=await Promise.all([this.i18n,this.dataSource]);try{const{outOfStock:a,cart:i}=await ee({element:this,instrumentName:v.MoreOptions,dataSource:n,willHandleErrorCodes(o){return o.length===1&&o[0]===p.InvalidQuantity}});if(y.sheetClicked({instrument:this.name,checkoutToken:Ue(i),result:"success"}),a){Se(r);return}Z(i.checkoutUrl,this.getShopPayBehavior())}catch(a){b.notify(new oo("An error occurred when attempting to a cart using the Shop Pay Button. Details: ".concat(a))),y.sheetClicked({instrument:this.name,result:"failed"}),q(r.translate("error_dialogs.checkout.title"),r.translate("error_dialogs.checkout.generic_error"))}}async render(){if(this.innerHTML)return;this.button||(this.button=document.createElement("gravity-button")),this.fragment||this.createAndAppendStyleFragment();const t=await this.classNames;await this.addButtonContent(),this.button.className=t,this.button.classList.add("gravity-button-wrapper"),this.disabled&&this.button.setAttribute("disabled",""),this.button.setAttribute("aria-hidden","true"),this.button.onclick=r=>this.handleClick(r),this.appendChild(this.button),this.onRendered()}}x("shop-promise-product-page-content",ao);class oo extends Error{constructor(){super(...arguments),d(this,"name","ShopPayButtonError")}}var so=Object.defineProperty,lo=Object.getOwnPropertyDescriptor,co=(e,t,r,n)=>{for(var a=lo(t,r),i=e.length-1,o;i>=0;i--)(o=e[i])&&(a=o(t,r,a)||a);return a&&so(t,r,a),a},le;const zn=(le=class extends G{static walletName(){return"shop_pay"}constructor(e){super(e)}getWebComponentName(){return"shop-pay-wallet-button"}getWebComponentClass(){return io}getInstrumentName(){return v.ShopPay}async loadWalletSDK(){await this.loadLogo()}getLoadEligibility(){return{eligible:!0}}async loadLogo(){le.shopPayLogoElement=(await import("./shop-pay-logo-CYhOC7ye.js")).default}},d(le,"shopPayLogoElement"),le);co([Pt("Shop Pay")],zn.prototype,"getLoadEligibility");let Hn=zn;const uo="shopify-google-pay-button[disabled]{opacity:.5;cursor:not-allowed;pointer-events:none}";class ho extends te{constructor(){super(),d(this,"name",v.GooglePay),d(this,"paymentsClient",null),d(this,"container",null),d(this,"measurementContainer",null),d(this,"resizeObserver",null),d(this,"onPaymentDataChanged",t=>{console.log("GooglePayButton::onPaymentDataChanged",t)}),d(this,"onPaymentAuthorized",t=>{console.log("GooglePayButton::onPaymentAuthorized",t)}),d(this,"onClick",()=>{console.log("GooglePayButton::onClick"),!this.disabled&&y.sheetClicked({instrument:this.name,result:"success"})}),this.resizeObserver=typeof ResizeObserver=="function"&&new ResizeObserver(()=>this.onResize())||null}static get observedAttributes(){return["disabled"]}connectedCallback(){this.cleanupOnFailure(this.render.bind(this),this.name)}disconnectedCallback(){this.resizeObserver&&this.resizeObserver.disconnect()}async onResize(){this.container.style.height="".concat(this.getContainerHeight(),"px")}getContainerHeight(){return this.measurementContainer.getBoundingClientRect().height}async createPaymentsClient(){const t={environment:this.walletParams.environment,merchantInfo:{merchantId:this.walletParams.merchantId,merchantName:this.walletParams.merchantName,merchantOrigin:this.walletParams.merchantOrigin,authJwt:this.walletParams.authJwt},paymentDataCallbacks:{onPaymentDataChanged:this.onPaymentDataChanged,onPaymentAuthorized:this.onPaymentAuthorized}};this.paymentsClient=new window.google.payments.api.PaymentsClient(t)}async setupRenderingContainers(){var t;const r=await this.classNames,n=document.createElement("style");this.container=document.createElement("div"),this.measurementContainer=document.createElement("div"),n.innerHTML=uo,this.appendChild(n),this.measurementContainer.className=r,V(this.measurementContainer,{"aria-hidden":"true",role:"button",tabindex:"-1"}),Q(this.measurementContainer,{display:"block",opacity:"0",visibility:"hidden","pointer-events":"none",position:"absolute"}),this.measurementContainer.innerHTML="&nbsp;",this.appendChild(this.measurementContainer),this.container.className=r,V(this.container,{role:"button"}),Q(this.container,{height:"".concat(this.getContainerHeight(),"px")}),this.appendChild(this.container),(t=this.resizeObserver)==null||t.observe(this.measurementContainer)}async renderFromGooglePaySDK(){if(!this.container)throw new Error("[".concat(v.GooglePay,"] button container not set when attempting to render"));if(!this.paymentsClient||!this.paymentsClient.createButton)throw new Error("[".concat(v.GooglePay,"] paymentsClient not set when attempting to render"));this.container.innerHTML="";const t=await this.i18n,r=wn(this.measurementContainer),n=this.paymentsClient.createButton({buttonColor:this.buttonTheme==="DARK"?"black":"white",buttonType:this.hasAttribute("call-to-action")?"buy":"plain",buttonSizeMode:"fill",buttonRadius:r!=null?r:0,buttonLocale:t.locale,onClick:this.onClick});this.container.appendChild(n)}async render(){await this.createPaymentsClient(),await this.setupRenderingContainers(),await this.renderFromGooglePaySDK(),this.onRendered()}}const Y=class Lo extends G{static walletName(){return"google_pay"}constructor(t){super(t)}getWebComponentName(){return"shopify-google-pay-button"}getInstrumentName(){return v.GooglePay}getWebComponentClass(){return ho}async loadWalletSDK(){if(Lo.googlePaySDKPromise)return Lo.googlePaySDKPromise;const t=document.createElement("script");return t.setAttribute("src",this.walletParams.sdkUrl),Lo.googlePaySDKPromise=new Promise((r,n)=>{t.onload=()=>r(),t.onerror=a=>{document.body.removeChild(t),n(a)},document.body.appendChild(t)}),Lo.googlePaySDKPromise}getLoadEligibility(){return{eligible:!0}}getPartnerSDKEligibility(){return{eligible:!0}}};d(Y,"googlePaySDKPromise");let mt=Y;const po=[xa,lt,It,mt,Ae,pt,Hn],mo=new Map(po.map(e=>[e.walletName(),t=>new e(t)]));function Le(e){const t=mo.get(e.name);return t?t(e):(console.debug("Can't build wallet with name ".concat(e.name)),null)}function yo(e){return e.map(t=>Le(t)).filter(t=>t!=null)}const qn="dynamic-checkout .wallet-button-fade-in,cart-wallet-buttons .wallet-button-fade-in{animation:animation-fade-in .3s cubic-bezier(.1,.79,1,1)}dynamic-checkout .shopify-payment-button__button,cart-wallet-buttons .shopify-payment-button__button{cursor:pointer}@keyframes animation-fade-in{0%{opacity:0}to{opacity:1}}button[aria-disabled=true]{opacity:.5;cursor:not-allowed}",go=".shopify-payment-button__button--hidden{visibility:hidden}.shopify-payment-button__button{border-radius:4px;border:none;box-shadow:0 0 0 0 transparent;color:#fff;cursor:pointer;display:block;font-size:1em;font-weight:500;line-height:1;text-align:center;width:100%;min-height:44px;transition:background .2s ease-in-out}.shopify-payment-button__button[disabled]{opacity:.6;cursor:default}.shopify-payment-button__button--unbranded{background-color:#1990c6;padding:1em 2em}.shopify-payment-button__button--unbranded:hover:not([disabled]){background-color:#136f99}.shopify-payment-button__more-options{background:transparent;border:0 none;cursor:pointer;display:block;font-size:1em;margin-top:1em;text-align:center;text-decoration:underline;width:100%}.shopify-payment-button__more-options.shopify-payment-button__skeleton{width:50%;margin-left:25%;margin-right:25%}.shopify-payment-button__more-options[disabled]{opacity:.6;cursor:default!important}.shopify-payment-button__button.shopify-payment-button__button--branded{display:flex;flex-direction:column;position:relative;z-index:1;--wallet-button-border-radius: 0px}.shopify-payment-button__button.shopify-payment-button__button--branded .shopify-cleanslate{flex:1!important;display:flex!important;flex-direction:column!important}.shopify-payment-button__button.button.loading{position:relative;color:transparent}.shopify-payment-button__button.button.loading>.loading-overlay__spinner{top:50%;left:50%;transform:translate(-50%,-50%);position:absolute;height:100%;display:flex;align-items:center}.shopify-payment-button__button.button.loading>.loading-overlay__spinner .spinner{width:-moz-fit-content;width:-webkit-fit-content;width:fit-content}.button.loading>.loading-overlay__spinner .path{stroke:#fff}.shopify-payment-button__button .loading-overlay__spinner{width:1.8rem;display:inline-block}.shopify-payment-button__button .spinner{animation:shopify-rotator 1.4s linear infinite}@keyframes shopify-rotator{0%{transform:rotate(0)}to{transform:rotate(270deg)}}.shopify-payment-button__button .path{stroke-dasharray:280;stroke-dashoffset:0;transform-origin:center;stroke:#121212;animation:shopify-dash 1.4s ease-in-out infinite}@media screen and (forced-colors: active){.shopify-payment-button__button .path{stroke:CanvasText}}@keyframes shopify-dash{0%{stroke-dashoffset:280}50%{stroke-dashoffset:75;transform:rotate(135deg)}to{stroke-dashoffset:280;transform:rotate(450deg)}}@keyframes walletsLoadingSkeleton{50%{opacity:1}75%{opacity:.5}to{opacity:1}}.shopify-payment-button__skeleton{animation:walletsLoadingSkeleton 4s ease infinite;animation-delay:-.168s;background-color:#dedede;box-sizing:border-box;text-decoration:none!important}";class fo{constructor(t,r,n){this.getElement=t,this.apiClient=r,this.instrumentName=n}async getCart(){const t=this.getElement(),r=Et(t);if(!r)throw new Error("[".concat(this.instrumentName,"] unable to find product form"));const n=W(dr),{data:a,errors:i}=await this.apiClient.createCart(I(w({},r),{discountCodes:n?[n]:[]}));if(!a)throw new Error("Failed to create cart: No cart returned");return{cart:a,errors:i}}}function jn({instanceNumber:e,styleId:t,styles:r,cssFileName:n}){var a,i;e===1&&(i=(a=window.Shopify)==null?void 0:a.PaymentButton)!=null&&i.isStorefrontPortableWallets&&(bo({styleId:t,styles:r,cssFileName:n})||wo({styleId:t,styles:r}))}function bo({styleId:e,styles:t,cssFileName:r}){return!!document.querySelector("style#".concat(e))}function wo({styleId:e,styles:t}){const r=document.createElement("style");r.id=e,r.innerHTML=t,document.head.appendChild(r)}const Vt=2e3,Fe=class zo extends _t{constructor(){super(),d(this,"instanceNumber",++zo.instanceCount),d(this,"formObserver"),d(this,"dataSource"),d(this,"wrapper"),d(this,"shopPromiseEligible"),d(this,"didInitiateRender",!1),this.wrapper=document.createElement("div"),wt({shop:{shopId:this.shopId}}),jn({instanceNumber:this.instanceNumber,styleId:"shopify-dynamic-checkout",styles:go,cssFileName:"dynamic-checkout-base.css"}),this.shopPromiseEligible=ln()}static get observedAttributes(){return["access-token","disabled","has-selling-plan","requires-shipping"]}async connectedCallback(){var t,r,n,a;try{if((r=(t=this.wrapper)==null?void 0:t.children)!=null&&r.length||this.didInitiateRender)return;if(!this.validateRenderingSurface()){this.clearUI();return}this.instanceNumber===1&&y.initStarted();const i=qe(L.ButtonDisplay,"dc:".concat(this.instanceNumber));this.i18n=Be(),this.setupFormObserver(),this.didInitiateRender=!0;const o=()=>this.wrapper,s=await this.loadWallet(),c=(s==null?void 0:s.getInstrumentName())===v.ApplePay||(s==null?void 0:s.getInstrumentName())===v.PayPal||(s==null?void 0:s.getInstrumentName())===v.GooglePay;this.apiClient=new Ke({accessToken:this.accessToken,country:this.buyerCountry,locale:this.i18n.locale,withCarrierRates:c}),this.dataSource=new fo(o,this.apiClient,(n=s==null?void 0:s.getInstrumentName())!=null?n:v.BuyItNow);const l=(a=s==null?void 0:s.getInstrumentName())!=null?a:v.BuyItNow,u=s==null?void 0:s.createWebComponent({walletContainer:this,dataSource:this.dataSource,i18n:this.i18n,apiClient:this.apiClient,classNames:Co(l),callToAction:"true",pageType:_.ProductPage,containerInstanceNumber:this.instanceNumber,onRendered:()=>y.instrumentLoaded({instrumentOrComponentName:l,result:"success",measurement:i()})});if(!u)throw new Gt("No web component found");this.render(u,l),y.initCompleted({result:"success"}),this.instanceNumber===1&&this.triggerLoadedEvent()}catch(i){this.clearUI(),y.initCompleted({error:i}),b.notify(new Gt("An error occurred while attempting to render the DynamicCheckout: ".concat(i)))}}async attributeChangedCallback(t,r,n){r!==n&&(vt(this,t,n),t==="has-selling-plan"&&this.toggleBuyerConsent(this.wrapper,this.apiClient,this.i18n))}render(t,r){this.clearUI();const n=document.createElement("style");n.innerHTML=qn,this.wrapper.className="wallet-button-fade-in",this.wrapper.appendChild(t),this.renderShopPromiseSlot(),this.renderMorePaymentOptionsLink(r);const a=new DocumentFragment;a.appendChild(n),a.appendChild(this.wrapper),this.appendChild(a)}renderMorePaymentOptionsLink(t){var r,n;if(t===v.BuyItNow)return;const a=document.createElement("more-payment-options-link");V(a,{"buyer-country":(r=this.buyerCountry)!=null?r:"","access-token":(n=this.accessToken)!=null?n:"","recommended-instrument":t}),a.disabled=this.disabled,a.setDataSource(this.dataSource),a.setI18n(this.i18n),a.setClassNames(et.MORE_PAYMENT_OPTION_BUTTON),this.wrapper.appendChild(a)}renderShopPromiseSlot(){if(!this.shopPromiseEligible)return;const t=document.createElement("div");t.setAttribute("data-shopify","shop-promise-payment-button-slot"),this.wrapper.appendChild(t)}clearUI(){this.innerHTML=""}validateRenderingSurface(){return St(this)!=null}async loadWallet(){const t=Ia(this.recommendedWallet,this.fallbackWallet,"DynamicCheckout");return await Ao(I(w({},t),{instanceNumber:this.instanceNumber}))}setupFormObserver(){this.formObserver||(this.formObserver=new mn(this,({disabled:t,hasSellingPlan:r})=>{this.disabled=t,this.hasSellingPlan=r,this.isShippingRequired=vo(this,this.variantParams)}),this.formObserver.setupMutationObservers())}};d(Fe,"instanceCount",0);let yt=Fe;function Co(e){return e===v.BuyItNow?et.UNBRANDED_BUTTON:et.BRANDED_BUTTON}function vo(e,t){var r;const n=Et(e);return!!((r=t.find(a=>a.id===Number(n==null?void 0:n.variantId)))!=null&&r.requiresShipping)}async function Ao({recommendedWallet:e,fallbackWallet:t,instanceNumber:r}){const n=e?Le(e):null,a=Le(t);if(At(n)){const i=ot({walletInstrument:n,instanceNumber:r}),o="timeout",s=await Promise.race([i,new Promise(c=>setTimeout(()=>c(o),Vt))]);if(s===o)y.instrumentSDKLoaded({instrument:n.getInstrumentName(),measurement:Vt,result:"timeout"});else if(s instanceof G)return s}return a&&ot({walletInstrument:a,instanceNumber:r})}x("dynamic-checkout",yt),x("more-payment-options-link",Qr,{isChildCustomElement:!0});class Gt extends Error{constructor(){super(...arguments),d(this,"name","DynamicCheckoutError")}}const _o=e=>{const t=new PerformanceObserver(r=>{r.getEntriesByType("resource").some(n=>n.name.includes(be.CartUpdate)||n.name.includes(be.CartChange)||n.name.includes(be.CartAdd)||n.name.includes(be.CartClear))&&e()});return t.observe({entryTypes:["resource"]}),t},Eo="#dynamic-checkout-cart{container-type:inline-size;container-name:dcc;--wallet-button-height-horizontal: 42px;--wallet-button-height-vertical: 54px;--wallet-button-width-horizontal: 150px;--wallet-button-width-vertical: 100%;--wallet-button-container-margin-horizontal: 0 5px 5px;--wallet-button-container-margin-vertical: 8px 0 0;--wallet-button-border-radius: 4px}.wallet-cart-grid{padding:0;display:flex;margin:0 -5px -5px auto;justify-content:flex-end;flex-direction:row}.wallet-cart-button-container{position:relative;margin:var(--wallet-button-container-margin-horizontal)}.wallet-cart-button-container,.wallet-cart-button{width:var(--wallet-button-width-horizontal);height:var(--wallet-button-height-horizontal);border-radius:var(--wallet-button-border-radius);list-style-type:none!important;text-align:center;flex-shrink:0;flex-grow:0}.additional-checkout-buttons--vertical .wallet-cart-grid{justify-content:flex-start;flex-direction:column;margin:0}.additional-checkout-buttons--vertical .wallet-cart-grid .wallet-cart-button-container{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical);margin:var(--wallet-button-container-margin-vertical)}.additional-checkout-buttons--vertical .wallet-cart-grid .wallet-cart-button{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical)}@container dcc (width >= 150px) and (width <= 500px){.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(1)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(2))){justify-content:flex-start;flex-direction:column;margin:0}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(1)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(2))) .wallet-cart-button-container{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical);margin:var(--wallet-button-container-margin-vertical)}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(1)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(2))) .wallet-cart-button{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical)}}@container dcc (width <= calc(300px + 1rem)){.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(2)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(3))){justify-content:flex-start;flex-direction:column;margin:0}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(2)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(3))) .wallet-cart-button-container{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical);margin:var(--wallet-button-container-margin-vertical)}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(2)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(3))) .wallet-cart-button{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical)}}@container dcc (width <= calc(450px + 2rem)){.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(3)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(4))){justify-content:flex-start;flex-direction:column;margin:0}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(3)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(4))) .wallet-cart-button-container{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical);margin:var(--wallet-button-container-margin-vertical)}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(3)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(4))) .wallet-cart-button{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical)}}@container dcc (width <= calc(600px + 3rem)){.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(4)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(5))){justify-content:flex-start;flex-direction:column;margin:0}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(4)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(5))) .wallet-cart-button-container{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical);margin:var(--wallet-button-container-margin-vertical)}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(4)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(5))) .wallet-cart-button{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical)}}@container dcc (width <= calc(750px + 4rem)){.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(5)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(6))){justify-content:flex-start;flex-direction:column;margin:0}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(5)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(6))) .wallet-cart-button-container{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical);margin:var(--wallet-button-container-margin-vertical)}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(5)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(6))) .wallet-cart-button{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical)}}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(6)){justify-content:flex-start;flex-direction:column;margin:0}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(6)) .wallet-cart-button-container{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical);margin:var(--wallet-button-container-margin-vertical)}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(6)) .wallet-cart-button{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical)}@media screen and (max-width: 750px){.wallet-cart-grid{justify-content:flex-start;flex-direction:column;max-width:none;margin:0}.wallet-cart-grid .wallet-cart-button-container{max-width:none;width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical);margin:var(--wallet-button-container-margin-vertical)}.wallet-cart-grid .wallet-cart-button{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical)}}@supports (not (container-type: inline-size)) or (not (selector(:has(*)))){.wallet-cart-grid{justify-content:flex-start;flex-direction:column;margin:0}.wallet-cart-button-container{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical);margin:var(--wallet-button-container-margin-vertical)}.wallet-cart-grid .wallet-cart-button{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical)}}@keyframes walletsLoadingSkeleton{50%{opacity:1}75%{opacity:.5}to{opacity:1}}.wallet-cart-button__skeleton{animation:walletsLoadingSkeleton 4s ease infinite;animation-delay:-.168s;background-color:#dedede;box-sizing:border-box;text-decoration:none!important}";class So{constructor(t,r){this.cartToken=t,this.apiClient=r}async getCart(){const t="gid://shopify/Cart/".concat(this.cartToken);return{cart:await this.apiClient.fetchCart(t),errors:[]}}}const $e=class qo extends _t{constructor(){super(),d(this,"instanceNumber",++qo.instanceCount),d(this,"cartObserver",null),d(this,"dataSource",null),d(this,"wrapper"),wt({shop:{shopId:this.shopId,cartId:this.cartId}}),jn({instanceNumber:this.instanceNumber,styleId:"shopify-dynamic-checkout-cart-grid",styles:Eo,cssFileName:"cart-wallet-buttons-base.css"}),this.wrapper=document.createElement("div")}static get observedAttributes(){return["access-token","has-selling-plan","requires-shipping"]}createDataSource(t){const r=W("cart");if(!r)throw new Error("[CartWalletButtons] cart cookie does not exist");const n=Be(),a=new Ke({accessToken:this.accessToken,country:this.buyerCountry,locale:n.locale,withCarrierRates:t}),i=new So(r,a);this.dataSource=i,this.apiClient=a,this.i18n=n}async createWebComponents({shouldRefetchCartAttributes:t}){if(!this.walletConfigs)throw new Error("[CartWalletButtons] walletConfigs does not exist");const r=Ca(this.walletConfigs,"CartWalletButtons");if(!(r instanceof Array))throw new Error("[CartWalletButtons] invalid walletConfigs found");const n=r.some(o=>o.name==="apple_pay"||o.name==="paypal");this.createDataSource(n),t&&await this.updateAttributes();const a=L.ButtonDisplay,i=o=>"".concat(o,":").concat(this.instanceNumber);return(await Po({walletConfigs:r,instanceNumber:this.instanceNumber,startButtonDisplayBenchmark:o=>je(a,i(o))})).map(o=>{const s=o.getInstrumentName();return o.createWebComponent({walletContainer:this,dataSource:this.dataSource,i18n:this.i18n,apiClient:this.apiClient,classNames:sr,pageType:_.CartPage,containerInstanceNumber:this.instanceNumber,onRendered:()=>y.instrumentLoaded({instrumentOrComponentName:s,result:"success",measurement:X(a,i(s))})})})}async cartChangedCallback(){try{const t=W("cart");if(!this.dataSource&&t){await this.render({shouldRefetchCartAttributes:!0});return}else if(!t){y.cartTokenMissing({reason:"cartChangedCallback"});return}await this.updateAttributes()}catch(t){this.innerHTML="",b.notify(t)}}async updateAttributes(){const{cart:t}=await this.dataSource.getCart();if(!(t!=null&&t.id))throw new Error("[".concat(this.updateAttributes,"] received invalid cart"));this.hasSellingPlan=t.lineItems.some(r=>r.sellingPlanAllocation!=null),this.isShippingRequired=t.lineItems.some(r=>r.merchandise.requiresShipping)}async connectedCallback(){try{if(R({event:N.CartInitCalled}),this.cartObserver=_o(()=>this.cartChangedCallback()),!W("cart")){y.cartTokenMissing({reason:"connectedCallback"});return}await this.render({shouldRefetchCartAttributes:!1})}catch(t){this.innerHTML="",b.notify(t)}}disconnectedCallback(){var t;(t=this.cartObserver)==null||t.disconnect()}async attributeChangedCallback(t,r,n){r!==n&&(vt(this,t,n),t==="has-selling-plan"&&this.toggleBuyerConsent(this.wrapper,this.apiClient,this.i18n))}async render({shouldRefetchCartAttributes:t}){if(this.hasLegacyCartCookie()){y.legacyCartCookie(),this.innerHTML="";return}const r=qe(L.ButtonDisplay,"cart:".concat(this.instanceNumber)),n=await this.createWebComponents({shouldRefetchCartAttributes:t});if(this.innerHTML="",n.length===0)return;const a=document.createElement("style");a.innerHTML=qn,this.wrapper=document.createElement("div"),this.wrapper.className="shopify-cleanslate wallet-button-fade-in";const i=document.createElement("ul");i.className="wallet-cart-grid",i.setAttribute("data-shopify-buttoncontainer","true"),i.setAttribute("role","list"),n.forEach(s=>{const c=document.createElement("li");c.className="wallet-cart-button-container",c.appendChild(s),c.setAttribute("data-testid","grid-cell"),i.appendChild(c)}),this.wrapper.appendChild(i),this.toggleBuyerConsent(this.wrapper,this.apiClient,this.i18n);const o=new DocumentFragment;o.appendChild(a),o.appendChild(this.wrapper),this.appendChild(o),y.instrumentLoaded({instrumentOrComponentName:"CartWalletButtons",result:"success",measurement:r()})}hasLegacyCartCookie(){const t=W("cart");return t?t==null?void 0:t.match(/^[a-z0-9]+$/):!1}};d($e,"instanceCount",0);let gt=$e;async function Po({walletConfigs:e,instanceNumber:t,startButtonDisplayBenchmark:r=()=>{}}){const n=Aa(yo(e));return(await Promise.all(n.map(a=>(r(a.getInstrumentName()),ot({walletInstrument:a,instanceNumber:t}))))).filter(a=>a!=null)}x("cart-wallet-buttons",gt);class Io{getCart(){throw new Error('[NoOpDataSource] Unexpected call to "getCart"')}}const Me=class jo extends _t{constructor(){super(),d(this,"instanceNumber",++jo.instanceCount),wt({shop:{shopId:this.shopId}})}get walletConfig(){return this.getAttribute("wallet-config")}get pageType(){return this.getAttribute("page-type")||_.Unknown}async connectedCallback(){try{if(this.children.length)return;this.instanceNumber===1&&y.initStarted();const t=qe(L.ButtonDisplay,"dc:".concat(this.instanceNumber)),r=va(this.walletConfig,"WalletButton");if(!r)throw new hr("[WalletButton] No config provided.");const n=Le(r);if(!n||!await this.eligibleToShow(n))return;const a=n.getInstrumentName();this.i18n=Be(),this.apiClient=new Ke({accessToken:this.accessToken,country:this.buyerCountry,locale:this.i18n.locale});const i=this.createWebComponent(n,this.i18n,this.apiClient,a,t);this.innerHTML="",this.appendChild(i),y.initCompleted({result:"success"}),this.instanceNumber===1&&this.triggerLoadedEvent()}catch(t){this.innerHTML="",y.initCompleted({error:t}),b.notify(t)}}createWebComponent(t,r,n,a,i){const o=t.createWebComponent({walletContainer:this,dataSource:new Io,i18n:r,apiClient:n,containerInstanceNumber:this.instanceNumber,pageType:this.pageType});return o.onRendered=()=>{y.instrumentLoaded({instrumentOrComponentName:a,result:"success",measurement:i()})},o}async eligibleToShow(t){return!(!At(t)||(await t.loadWalletSDK(),!t.getPartnerSDKEligibility().eligible))}};d(Me,"instanceCount",0);let ft=Me;x("shopify-wallet-button",ft),ir(b),or(b),y.startExporter();
